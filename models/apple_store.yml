
version: 2

models:
  - name: apple_store__subscriptions_report
    description: Each record represents daily subscription metrics by account, app, subscription name, country and state
    tests: 
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - date_day
            - account_id
            - app_id
            - subscription_name
            - country
            - state
    columns:
      - name: date_day
      - name: account_id
      - name: account_name
      - name: app_id
      - name: app_name
      - name: subscription_name
      - name: country
      - name: state

  - name: apple_store__territory_report
    description: Each record represents daily subscription metrics by app_id, source_type and territory
    tests: 
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - date_day
            - app_id
            - source_type
            - territory
    columns:
      - name: date_day
      - name: app_id
      - name: source_type
      - name: territory
      - name: impressions
      - name: impressions_unique_device
      - name: page_views
      - name: page_views_unique_device
      - name: first_time_downloads
      - name: redownloads
      - name: total_downloads
      - name: active_devices
      - name: active_devices_last_30_days
      - name: deletions
      - name: installations
      - name: sessions 

  - name: apple_store__device_report
    description: Each record represents daily subscription metrics by app_id, source_type and device
    tests: 
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - date_day
            - app_id
            - source_type
            - device
    columns:
      - name: date_day
      - name: app_id
      - name: source_type
        description: a little weird bc crashes doesn't have corresponding source type
      - name: device
      - name: impressions
      - name: impressions_unique_device
      - name: page_views
      - name: page_views_unique_device
      - name: first_time_downloads
      - name: redownloads
      - name: total_downloads
      - name: active_devices
      - name: active_devices_last_30_days
      - name: deletions
      - name: installations
      - name: sessions 
      - name: crashes
        description: The number of reported crashes for a given report day; a value of 0 indicates there were 0 crash reports or no value from the crash report that day

  - name: apple_store__source_type_report
    description: Each record represents daily metrics by app_id and source_type
    tests: 
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - date_day
            - app_id
            - source_type
    columns:
      - name: date_day
      - name: app_id
      - name: source_type
      - name: impressions
      - name: impressions_unique_device
      - name: page_views
      - name: page_views_unique_device
      - name: first_time_downloads
      - name: redownloads
      - name: total_downloads
      - name: active_devices
      - name: active_devices_last_30_days
      - name: deletions
      - name: installations
      - name: sessions 

  - name: apple_store__overview_report
    description: Each record represents daily metrics for each app_id
    tests: 
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - date_day
            - app_id
    columns:
      - name: date_day
      - name: app_id
      - name: impressions
      - name: impressions_unique_device
      - name: page_views
      - name: page_views_unique_device
      - name: first_time_downloads
      - name: redownloads
      - name: total_downloads
      - name: active_devices
      - name: active_devices_last_30_days
      - name: deletions
      - name: installations
      - name: sessions 