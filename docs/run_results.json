{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2024-03-13T14:21:22.279483Z", "invocation_id": "55a3ef9d-c7e5-4e48-86ff-b61b03f92331", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.499630Z", "completed_at": "2024-03-13T14:21:20.512412Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.513989Z", "completed_at": "2024-03-13T14:21:20.514002Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018353939056396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_device_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"app_store_source_type_device\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_device_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.506967Z", "completed_at": "2024-03-13T14:21:20.513279Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.515692Z", "completed_at": "2024-03-13T14:21:20.515695Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.019331693649291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_territory_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"app_store_territory_source_type\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_territory_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.504817Z", "completed_at": "2024-03-13T14:21:20.513629Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.516226Z", "completed_at": "2024-03-13T14:21:20.516229Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020555973052978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_platform_version_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"app_store_platform_version_source_type\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.509114Z", "completed_at": "2024-03-13T14:21:20.514584Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.517499Z", "completed_at": "2024-03-13T14:21:20.517504Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02118706703186035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"app\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.521468Z", "completed_at": "2024-03-13T14:21:20.527719Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.533616Z", "completed_at": "2024-03-13T14:21:20.533624Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01636791229248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_app_version_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"crashes_app_version\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_app_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.524913Z", "completed_at": "2024-03-13T14:21:20.533287Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.535194Z", "completed_at": "2024-03-13T14:21:20.535198Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01643681526184082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_platform_version_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"crashes_platform_version\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.528078Z", "completed_at": "2024-03-13T14:21:20.534173Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.537633Z", "completed_at": "2024-03-13T14:21:20.537639Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018375873565673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_device_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"downloads_source_type_device\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_device_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.530650Z", "completed_at": "2024-03-13T14:21:20.535555Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.538875Z", "completed_at": "2024-03-13T14:21:20.538881Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.016637086868286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_platform_version_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"downloads_platform_version_source_type\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.541645Z", "completed_at": "2024-03-13T14:21:20.549458Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.556076Z", "completed_at": "2024-03-13T14:21:20.556083Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019356966018676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_territory_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"downloads_territory_source_type\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_territory_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.546462Z", "completed_at": "2024-03-13T14:21:20.550003Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.556449Z", "completed_at": "2024-03-13T14:21:20.556454Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017990827560424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_account_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"sales_account\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_account_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.550259Z", "completed_at": "2024-03-13T14:21:20.556767Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.560246Z", "completed_at": "2024-03-13T14:21:20.560253Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015918970108032227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_events_tmp", "compiled": true, "compiled_code": "\n\nselect * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"sales_subscription_events\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_events_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.553334Z", "completed_at": "2024-03-13T14:21:20.557684Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.561039Z", "completed_at": "2024-03-13T14:21:20.561043Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.013841867446899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_summary_tmp", "compiled": true, "compiled_code": "\n\nselect * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"sales_subscription_summary\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_summary_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.563464Z", "completed_at": "2024-03-13T14:21:20.569950Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.576549Z", "completed_at": "2024-03-13T14:21:20.576555Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0173032283782959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_app_version_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"usage_app_version_source_type\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_app_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.566363Z", "completed_at": "2024-03-13T14:21:20.570483Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.576979Z", "completed_at": "2024-03-13T14:21:20.576989Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017084836959838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_device_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"usage_source_type_device\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_device_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.570745Z", "completed_at": "2024-03-13T14:21:20.577353Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.579848Z", "completed_at": "2024-03-13T14:21:20.579852Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01265263557434082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_platform_version_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"usage_platform_version_source_type\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.573936Z", "completed_at": "2024-03-13T14:21:20.578970Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.581720Z", "completed_at": "2024-03-13T14:21:20.581724Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01381826400756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_territory_tmp", "compiled": true, "compiled_code": "select * \nfrom \"postgres\".\"apple_store_integration_tests_6\".\"usage_territory_source_type\"", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_territory_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.583329Z", "completed_at": "2024-03-13T14:21:20.584565Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.588058Z", "completed_at": "2024-03-13T14:21:20.588063Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00992584228515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.584931Z", "completed_at": "2024-03-13T14:21:20.585900Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.588415Z", "completed_at": "2024-03-13T14:21:20.588418Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009987831115722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app_store_platform_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.588673Z", "completed_at": "2024-03-13T14:21:20.589628Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.594003Z", "completed_at": "2024-03-13T14:21:20.594007Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00916600227355957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app_store_source_type_device", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.591386Z", "completed_at": "2024-03-13T14:21:20.593076Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.595679Z", "completed_at": "2024-03-13T14:21:20.595682Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009459972381591797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app_store_territory_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.597530Z", "completed_at": "2024-03-13T14:21:20.598572Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.602050Z", "completed_at": "2024-03-13T14:21:20.602057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009833097457885742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.crashes_app_version", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.598888Z", "completed_at": "2024-03-13T14:21:20.599742Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.602352Z", "completed_at": "2024-03-13T14:21:20.602356Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009895086288452148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.crashes_platform_version", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.602609Z", "completed_at": "2024-03-13T14:21:20.603653Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.607246Z", "completed_at": "2024-03-13T14:21:20.607250Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008563041687011719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.downloads_platform_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.605320Z", "completed_at": "2024-03-13T14:21:20.606318Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.608882Z", "completed_at": "2024-03-13T14:21:20.608886Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008394002914428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.downloads_source_type_device", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.610316Z", "completed_at": "2024-03-13T14:21:20.611374Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.615472Z", "completed_at": "2024-03-13T14:21:20.615476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00992894172668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.downloads_territory_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.611695Z", "completed_at": "2024-03-13T14:21:20.613444Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.615728Z", "completed_at": "2024-03-13T14:21:20.615730Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010042190551757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.sales_account", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.615976Z", "completed_at": "2024-03-13T14:21:20.616966Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.620366Z", "completed_at": "2024-03-13T14:21:20.620371Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008162975311279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.sales_subscription_events", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.618648Z", "completed_at": "2024-03-13T14:21:20.619602Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.622208Z", "completed_at": "2024-03-13T14:21:20.622211Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008172988891601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.sales_subscription_summary", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.623606Z", "completed_at": "2024-03-13T14:21:20.624548Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.627704Z", "completed_at": "2024-03-13T14:21:20.627708Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008913278579711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_app_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.624837Z", "completed_at": "2024-03-13T14:21:20.625716Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.627953Z", "completed_at": "2024-03-13T14:21:20.627956Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008970975875854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_platform_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.628218Z", "completed_at": "2024-03-13T14:21:20.629153Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.633361Z", "completed_at": "2024-03-13T14:21:20.633367Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008733272552490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_source_type_device", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.630770Z", "completed_at": "2024-03-13T14:21:20.632509Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.635022Z", "completed_at": "2024-03-13T14:21:20.635026Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008739948272705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_territory_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.636410Z", "completed_at": "2024-03-13T14:21:20.637475Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.645179Z", "completed_at": "2024-03-13T14:21:20.645184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016254186630249023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_source.apple_store_country_codes", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.645662Z", "completed_at": "2024-03-13T14:21:20.919367Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.921395Z", "completed_at": "2024-03-13T14:21:20.921399Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3030881881713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_territory", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_territory_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    impressions_unique_device\n    \n as \n    \n    impressions_unique_device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    page_views\n    \n as \n    \n    page_views\n    \n, \n    \n    \n    page_views_unique_device\n    \n as \n    \n    page_views_unique_device\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    territory\n    \n as \n    \n    territory\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        territory,\n        impressions,\n        impressions_unique_device,\n        page_views,\n        page_views_unique_device\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_territory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.650842Z", "completed_at": "2024-03-13T14:21:20.912429Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.919756Z", "completed_at": "2024-03-13T14:21:20.919768Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.30256009101867676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    impressions_unique_device\n    \n as \n    \n    impressions_unique_device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    page_views\n    \n as \n    \n    page_views\n    \n, \n    \n    \n    page_views_unique_device\n    \n as \n    \n    page_views_unique_device\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        platform_version,\n        impressions,\n        impressions_unique_device,\n        page_views,\n        page_views_unique_device\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.656250Z", "completed_at": "2024-03-13T14:21:20.919085Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.921132Z", "completed_at": "2024-03-13T14:21:20.921136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.29299306869506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_opt_in_rate\n    \n as \n    \n    app_opt_in_rate\n    \n, \n    \n    \n    asset_token\n    \n as \n    \n    asset_token\n    \n, \n    \n    \n    icon_url\n    \n as \n    \n    icon_url\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ios\n    \n as \n    \n    ios\n    \n, \n    \n    \n    is_bundle\n    \n as \n    \n    is_bundle\n    \n, \n    \n    \n    is_enabled\n    \n as \n    \n    is_enabled\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    pre_order_info\n    \n as \n    \n    pre_order_info\n    \n, \n    \n    \n    tvos\n    \n as \n    \n    tvos\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        id as app_id,\n        name as app_name,\n        is_enabled\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.637769Z", "completed_at": "2024-03-13T14:21:20.920555Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:20.922426Z", "completed_at": "2024-03-13T14:21:20.922429Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3575458526611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_device", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_device_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    impressions_unique_device\n    \n as \n    \n    impressions_unique_device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    page_views\n    \n as \n    \n    page_views\n    \n, \n    \n    \n    page_views_unique_device\n    \n as \n    \n    page_views_unique_device\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        device,\n        impressions,\n        impressions_unique_device,\n        page_views,\n        page_views_unique_device\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_device\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.992958Z", "completed_at": "2024-03-13T14:21:21.257394Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.258368Z", "completed_at": "2024-03-13T14:21:21.258376Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3289170265197754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_device", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_device_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    first_time_downloads\n    \n as \n    \n    first_time_downloads\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    redownloads\n    \n as \n    \n    redownloads\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    total_downloads\n    \n as \n    \n    total_downloads\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        device,\n        first_time_downloads,\n        redownloads,\n        total_downloads\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_device\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.015250Z", "completed_at": "2024-03-13T14:21:21.258086Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.259157Z", "completed_at": "2024-03-13T14:21:21.259161Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2783088684082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    first_time_downloads\n    \n as \n    \n    first_time_downloads\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n, \n    \n    \n    redownloads\n    \n as \n    \n    redownloads\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    total_downloads\n    \n as \n    \n    total_downloads\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        platform_version,\n        first_time_downloads,\n        redownloads,\n        total_downloads\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.955298Z", "completed_at": "2024-03-13T14:21:21.270070Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.270597Z", "completed_at": "2024-03-13T14:21:21.270604Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3506889343261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    crashes\n    \n as \n    \n    crashes\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        device,\n        platform_version,\n        crashes\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:20.949712Z", "completed_at": "2024-03-13T14:21:21.300399Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.301879Z", "completed_at": "2024-03-13T14:21:21.301885Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3908228874206543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_app_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_app_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_version\n    \n as \n    \n    app_version\n    \n, \n    \n    \n    crashes\n    \n as \n    \n    crashes\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        device,\n        app_version,\n        crashes\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_app_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.290251Z", "completed_at": "2024-03-13T14:21:21.555490Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.556520Z", "completed_at": "2024-03-13T14:21:21.556524Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.29947900772094727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_account", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_account_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        id as account_id,\n        name as account_name\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_account\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.286101Z", "completed_at": "2024-03-13T14:21:21.554540Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.555774Z", "completed_at": "2024-03-13T14:21:21.555782Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3010079860687256, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_territory", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_territory_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    first_time_downloads\n    \n as \n    \n    first_time_downloads\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    redownloads\n    \n as \n    \n    redownloads\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    territory\n    \n as \n    \n    territory\n    \n, \n    \n    \n    total_downloads\n    \n as \n    \n    total_downloads\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        territory,\n        first_time_downloads,\n        redownloads,\n        total_downloads\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_territory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.302750Z", "completed_at": "2024-03-13T14:21:21.586105Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.591896Z", "completed_at": "2024-03-13T14:21:21.591902Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.34055089950561523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_events", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_events_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _filename\n    \n as \n    \n    _filename\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _index\n    \n as \n    \n    _index\n    \n, \n    \n    \n    account_number\n    \n as \n    \n    account_number\n    \n, \n    \n    \n    app_apple_id\n    \n as \n    \n    app_apple_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    cancellation_reason\n    \n as \n    \n    cancellation_reason\n    \n, \n    \n    \n    consecutive_paid_periods\n    \n as \n    \n    consecutive_paid_periods\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    days_before_canceling\n    \n as \n    \n    days_before_canceling\n    \n, \n    \n    \n    days_canceled\n    \n as \n    \n    days_canceled\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    event\n    \n as \n    \n    event\n    \n, \n    \n    \n    event_date\n    \n as \n    \n    event_date\n    \n, \n    \n    \n    marketing_opt_in_duration\n    \n as \n    \n    marketing_opt_in_duration\n    \n, \n    \n    \n    original_start_date\n    \n as \n    \n    original_start_date\n    \n, \n    \n    \n    previous_subscription_apple_id\n    \n as \n    \n    previous_subscription_apple_id\n    \n, \n    \n    \n    previous_subscription_name\n    \n as \n    \n    previous_subscription_name\n    \n, \n    \n    \n    proceeds_reason\n    \n as \n    \n    proceeds_reason\n    \n, \n    \n    \n    promotional_offer_id\n    \n as \n    \n    promotional_offer_id\n    \n, \n    \n    \n    promotional_offer_name\n    \n as \n    \n    promotional_offer_name\n    \n, \n    \n    \n    quantity\n    \n as \n    \n    quantity\n    \n, \n    \n    \n    standard_subscription_duration\n    \n as \n    \n    standard_subscription_duration\n    \n, \n    \n    \n    state\n    \n as \n    \n    state\n    \n, \n    \n    \n    subscription_apple_id\n    \n as \n    \n    subscription_apple_id\n    \n, \n    \n    \n    subscription_group_id\n    \n as \n    \n    subscription_group_id\n    \n, \n    \n    \n    subscription_name\n    \n as \n    \n    subscription_name\n    \n, \n    \n    \n    subscription_offer_duration\n    \n as \n    \n    subscription_offer_duration\n    \n, \n    \n    \n    subscription_offer_type\n    \n as \n    \n    subscription_offer_type\n    \n, \n    \n    \n    vendor_number\n    \n as \n    \n    vendor_number\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(event_date as date) as date_day,\n        account_number as account_id,\n        app_name,\n        subscription_name,\n        event,\n        country,\n        case\n            when replace(state, ' ', '') = '' then cast(null as TEXT) else state\n        end as state,\n        case \n            when lower(device) like 'ipod%' then 'iPod' else device\n        end as device,\n        sum(quantity) as quantity\n    from fields\n    group by 1,2,3,4,5,6,7,8\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.340094Z", "completed_at": "2024-03-13T14:21:21.617498Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.618161Z", "completed_at": "2024-03-13T14:21:21.618169Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3086509704589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_summary", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_summary_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _filename\n    \n as \n    \n    _filename\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _index\n    \n as \n    \n    _index\n    \n, \n    \n    \n    account_number\n    \n as \n    \n    account_number\n    \n, \n    \n    \n    active_free_trial_introductory_offer_subscriptions\n    \n as \n    \n    active_free_trial_introductory_offer_subscriptions\n    \n, \n    \n    \n    active_pay_as_you_go_introductory_offer_subscriptions\n    \n as \n    \n    active_pay_as_you_go_introductory_offer_subscriptions\n    \n, \n    \n    \n    active_pay_up_front_introductory_offer_subscriptions\n    \n as \n    \n    active_pay_up_front_introductory_offer_subscriptions\n    \n, \n    \n    \n    active_standard_price_subscriptions\n    \n as \n    \n    active_standard_price_subscriptions\n    \n, \n    \n    \n    app_apple_id\n    \n as \n    \n    app_apple_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    billing_retry\n    \n as \n    \n    billing_retry\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    customer_currency\n    \n as \n    \n    customer_currency\n    \n, \n    \n    \n    customer_price\n    \n as \n    \n    customer_price\n    \n, \n    \n    \n    developer_proceeds\n    \n as \n    \n    developer_proceeds\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    free_trial_promotional_offer_subscriptions\n    \n as \n    \n    free_trial_promotional_offer_subscriptions\n    \n, \n    \n    \n    grace_period\n    \n as \n    \n    grace_period\n    \n, \n    \n    \n    marketing_opt_ins\n    \n as \n    \n    marketing_opt_ins\n    \n, \n    \n    \n    pay_as_you_go_promotional_offer_subscriptions\n    \n as \n    \n    pay_as_you_go_promotional_offer_subscriptions\n    \n, \n    \n    \n    pay_up_front_promotional_offer_subscriptions\n    \n as \n    \n    pay_up_front_promotional_offer_subscriptions\n    \n, \n    \n    \n    proceeds_currency\n    \n as \n    \n    proceeds_currency\n    \n, \n    \n    \n    proceeds_reason\n    \n as \n    \n    proceeds_reason\n    \n, \n    \n    \n    promotional_offer_id\n    \n as \n    \n    promotional_offer_id\n    \n, \n    \n    \n    promotional_offer_name\n    \n as \n    \n    promotional_offer_name\n    \n, \n    \n    \n    standard_subscription_duration\n    \n as \n    \n    standard_subscription_duration\n    \n, \n    \n    \n    state\n    \n as \n    \n    state\n    \n, \n    \n    \n    subscription_apple_id\n    \n as \n    \n    subscription_apple_id\n    \n, \n    \n    \n    subscription_group_id\n    \n as \n    \n    subscription_group_id\n    \n, \n    \n    \n    subscription_name\n    \n as \n    \n    subscription_name\n    \n, \n    \n    \n    vendor_number\n    \n as \n    \n    vendor_number\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        \n\n    to_date(\n      \n\n  \n    \n\n    split_part(\n        _filename,\n        '_',\n        3\n        )\n\n\n  \n\n, \n      'YYYYMMDD'\n    )\n\n as date_day, \n        app_name,\n        account_number as account_id,\n        country,\n        case\n            when replace(state, ' ', '') = '' then cast(null as TEXT)  else state\n        end as state,\n        subscription_name,\n        case \n            when lower(device) like 'ipod%' then 'iPod' else device\n        end as device,\n        sum(active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from fields\n    group by 1,2,3,4,5,6,7\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.587325Z", "completed_at": "2024-03-13T14:21:21.871616Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.873079Z", "completed_at": "2024-03-13T14:21:21.873083Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.31288814544677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_app_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_app_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_version\n    \n as \n    \n    app_version\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        app_version,\n        active_devices,\n        active_devices_last_30_days,\n        deletions,\n        installations,\n        sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_app_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.612257Z", "completed_at": "2024-03-13T14:21:21.870615Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.872185Z", "completed_at": "2024-03-13T14:21:21.872194Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.30744218826293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_device", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_device_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        device,\n        active_devices,\n        active_devices_last_30_days,\n        deletions,\n        installations,\n        sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_device\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.643918Z", "completed_at": "2024-03-13T14:21:21.894312Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.895033Z", "completed_at": "2024-03-13T14:21:21.895041Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.27779674530029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        platform_version,\n        active_devices,\n        active_devices_last_30_days,\n        deletions,\n        installations,\n        sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.900978Z", "completed_at": "2024-03-13T14:21:21.920030Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.922304Z", "completed_at": "2024-03-13T14:21:21.922309Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.024384021759033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_store_territory_date_day__app_id__source_type__territory.7cdae53c6f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, territory\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_territory\"\n    group by date_day, app_id, source_type, territory\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.916079Z", "completed_at": "2024-03-13T14:21:21.921530Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.924121Z", "completed_at": "2024-03-13T14:21:21.924125Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024863004684448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_store_platform_version_date_day__app_id__source_type__platform_version.80fbd35d7a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, platform_version\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_platform_version\"\n    group by date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.925758Z", "completed_at": "2024-03-13T14:21:21.935030Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.938825Z", "completed_at": "2024-03-13T14:21:21.938833Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01639389991760254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.unique_stg_apple_store__app_app_id.d811c134aa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    app_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\nwhere app_id is not null\ngroup by app_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.650069Z", "completed_at": "2024-03-13T14:21:21.920414Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.922930Z", "completed_at": "2024-03-13T14:21:21.922934Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.304793119430542, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_territory", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_territory_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    territory\n    \n as \n    \n    territory\n    \n\n\n\n        \n    from base\n),\n\nfinal as (\n    \n    select \n        cast(date as date) as date_day,\n        app_id,\n        source_type,\n        territory,\n        active_devices,\n        active_devices_last_30_days,\n        deletions,\n        installations,\n        sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_territory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.943297Z", "completed_at": "2024-03-13T14:21:21.954432Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.957412Z", "completed_at": "2024-03-13T14:21:21.957416Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01741790771484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_store_device_date_day__app_id__source_type__device.b68460b067", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, device\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_device\"\n    group by date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.959694Z", "completed_at": "2024-03-13T14:21:21.967681Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.974435Z", "completed_at": "2024-03-13T14:21:21.974443Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01871514320373535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__downloads_device_date_day__app_id__source_type__device.5d2738acd2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, device\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_device\"\n    group by date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.964562Z", "completed_at": "2024-03-13T14:21:21.974741Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.977486Z", "completed_at": "2024-03-13T14:21:21.977490Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01953887939453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__downloads_platform_version_date_day__app_id__source_type__platform_version.35be5774dc", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, platform_version\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_platform_version\"\n    group by date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.971602Z", "completed_at": "2024-03-13T14:21:21.976279Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:21.979206Z", "completed_at": "2024-03-13T14:21:21.979210Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01634526252746582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__crashes_platform_version_date_day__app_id__device__platform_version.94808fafb3", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, device, platform_version\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_platform_version\"\n    group by date_day, app_id, device, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.993291Z", "completed_at": "2024-03-13T14:21:21.999295Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.006051Z", "completed_at": "2024-03-13T14:21:22.006058Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024313926696777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__crashes_app_version_date_day__app_id__device__app_version.d812a1af75", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, device, app_version\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_app_version\"\n    group by date_day, app_id, device, app_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:21.999572Z", "completed_at": "2024-03-13T14:21:22.006390Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.014608Z", "completed_at": "2024-03-13T14:21:22.014613Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0187838077545166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.unique_stg_apple_store__sales_account_account_id.da7b3695e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    account_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_account\"\nwhere account_id is not null\ngroup by account_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.003129Z", "completed_at": "2024-03-13T14:21:22.013923Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.016708Z", "completed_at": "2024-03-13T14:21:22.016711Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01931476593017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__downloads_territory_date_day__app_id__source_type__territory.d61d29a8f6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, territory\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_territory\"\n    group by date_day, app_id, source_type, territory\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.018206Z", "completed_at": "2024-03-13T14:21:22.024426Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.037480Z", "completed_at": "2024-03-13T14:21:22.037489Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.024185895919799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__sales_subscription_events_date_day__account_id__app_name__subscription_name__device__event__country__state.bea0346a67", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, account_id, app_name, subscription_name, device, event, country, state\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_events\"\n    group by date_day, account_id, app_name, subscription_name, device, event, country, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.034560Z", "completed_at": "2024-03-13T14:21:22.039930Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.042576Z", "completed_at": "2024-03-13T14:21:22.042579Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019947052001953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__sales_subscription_summary_date_day__account_id__app_name__subscription_name__device__country__state.1e5fa4e8a4", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, account_id, app_name, subscription_name, device, country, state\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_summary\"\n    group by date_day, account_id, app_name, subscription_name, device, country, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.044757Z", "completed_at": "2024-03-13T14:21:22.053721Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.058598Z", "completed_at": "2024-03-13T14:21:22.058602Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01783895492553711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_app_version_date_day__app_id__source_type__app_version.05a3d415a2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, app_version\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_app_version\"\n    group by date_day, app_id, source_type, app_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.054193Z", "completed_at": "2024-03-13T14:21:22.059298Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.062343Z", "completed_at": "2024-03-13T14:21:22.062351Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01091313362121582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_device_date_day__app_id__source_type__device.b45a8a5145", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, device\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_device\"\n    group by date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.064138Z", "completed_at": "2024-03-13T14:21:22.076256Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.095218Z", "completed_at": "2024-03-13T14:21:22.095227Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.03527402877807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_platform_version_date_day__app_id__source_type__platform_version.1231bf88e6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, platform_version\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_platform_version\"\n    group by date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.067255Z", "completed_at": "2024-03-13T14:21:22.076870Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.095758Z", "completed_at": "2024-03-13T14:21:22.095762Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.035355329513549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__territory_report", "compiled": true, "compiled_code": "with app as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\napp_store_territory as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_territory\"\n),\n\ncountry_codes as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"apple_store_country_codes\"\n),\n\ndownloads_territory as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_territory\"\n),\n\nusage_territory as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_territory\"\n),\n\nreporting_grain as (\n\n    select distinct\n        date_day,\n        app_id,\n        source_type,\n        territory \n    from app_store_territory\n),\n\njoined as (\n\n    select \n        reporting_grain.date_day,\n        reporting_grain.app_id,\n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.territory as territory_long,\n        coalesce(official_country_codes.country_code_alpha_2, alternative_country_codes.country_code_alpha_2) as territory_short,\n        coalesce(official_country_codes.region, alternative_country_codes.region) as region,\n        coalesce(official_country_codes.sub_region, alternative_country_codes.sub_region) as sub_region,\n        coalesce(app_store_territory.impressions, 0) as impressions,\n        coalesce(app_store_territory.impressions_unique_device, 0) as impressions_unique_device,\n        coalesce(app_store_territory.page_views, 0) as page_views,\n        coalesce(app_store_territory.page_views_unique_device, 0) as page_views_unique_device,\n        coalesce(downloads_territory.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_territory.redownloads, 0) as redownloads,\n        coalesce(downloads_territory.total_downloads, 0) as total_downloads,\n        coalesce(usage_territory.active_devices, 0) as active_devices,\n        coalesce(usage_territory.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_territory.deletions, 0) as deletions,\n        coalesce(usage_territory.installations, 0) as installations,\n        coalesce(usage_territory.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n    left join app_store_territory \n        on reporting_grain.date_day = app_store_territory.date_day\n        and reporting_grain.app_id = app_store_territory.app_id \n        and reporting_grain.source_type = app_store_territory.source_type\n        and reporting_grain.territory = app_store_territory.territory\n    left join downloads_territory\n        on reporting_grain.date_day = downloads_territory.date_day\n        and reporting_grain.app_id = downloads_territory.app_id \n        and reporting_grain.source_type = downloads_territory.source_type\n        and reporting_grain.territory = downloads_territory.territory\n    left join usage_territory\n        on reporting_grain.date_day = usage_territory.date_day\n        and reporting_grain.app_id = usage_territory.app_id \n        and reporting_grain.source_type = usage_territory.source_type\n        and reporting_grain.territory = usage_territory.territory\n    left join country_codes as official_country_codes\n        on reporting_grain.territory = official_country_codes.country_name\n    left join country_codes as alternative_country_codes\n        on reporting_grain.territory = alternative_country_codes.alternative_country_name\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__territory_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.073128Z", "completed_at": "2024-03-13T14:21:22.077433Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.096701Z", "completed_at": "2024-03-13T14:21:22.096704Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03524208068847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_territory_date_day__app_id__source_type__territory.8e3efb4939", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, territory\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_territory\"\n    group by date_day, app_id, source_type, territory\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.077727Z", "completed_at": "2024-03-13T14:21:22.097524Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.100119Z", "completed_at": "2024-03-13T14:21:22.100123Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025593996047973633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__platform_version_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__platform_version as (\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_platform_version\"\n),\n\naggregated as (\n\n    select \n        date_day, \n        app_id,\n        platform_version,\n        cast(null as TEXT) as source_type,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3,4\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\napp_store_platform_version as (\n    \n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_platform_version\"\n),\n\ncrashes_platform_version as (\n    \n    select *\n    from __dbt__cte__int_apple_store__platform_version\n),\n\ndownloads_platform_version as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_platform_version\"\n),\n\nusage_platform_version as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_platform_version\"\n),\n\nreporting_grain_combined as (\n\n    select\n        date_day,\n        app_id,\n        source_type,\n        platform_version\n    from app_store_platform_version\n    union all\n    select \n        date_day,\n        app_id,\n        source_type,\n        platform_version\n    from crashes_platform_version\n),\n\nreporting_grain as (\n\n    select \n        distinct *\n    from reporting_grain_combined\n\n),\n\njoined as (\n\n    select \n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.platform_version,\n        coalesce(app_store_platform_version.impressions, 0) as impressions,\n        coalesce(app_store_platform_version.impressions_unique_device, 0) as impressions_unique_device,\n        coalesce(app_store_platform_version.page_views, 0) as page_views,\n        coalesce(app_store_platform_version.page_views_unique_device, 0) as page_views_unique_device,\n        coalesce(crashes_platform_version.crashes, 0) as crashes,\n        coalesce(downloads_platform_version.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_platform_version.redownloads, 0) as redownloads,\n        coalesce(downloads_platform_version.total_downloads, 0) as total_downloads,\n        coalesce(usage_platform_version.active_devices, 0) as active_devices,\n        coalesce(usage_platform_version.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_platform_version.deletions, 0) as deletions,\n        coalesce(usage_platform_version.installations, 0) as installations,\n        coalesce(usage_platform_version.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n    left join app_store_platform_version \n        on reporting_grain.date_day = app_store_platform_version.date_day\n        and reporting_grain.app_id = app_store_platform_version.app_id \n        and reporting_grain.source_type = app_store_platform_version.source_type\n        and reporting_grain.platform_version = app_store_platform_version.platform_version\n    left join crashes_platform_version\n        on reporting_grain.date_day = crashes_platform_version.date_day\n        and reporting_grain.app_id = crashes_platform_version.app_id\n        and reporting_grain.source_type = crashes_platform_version.source_type\n        and reporting_grain.platform_version = crashes_platform_version.platform_version    \n    left join downloads_platform_version\n        on reporting_grain.date_day = downloads_platform_version.date_day\n        and reporting_grain.app_id = downloads_platform_version.app_id \n        and reporting_grain.source_type = downloads_platform_version.source_type\n        and reporting_grain.platform_version = downloads_platform_version.platform_version\n    left join usage_platform_version\n        on reporting_grain.date_day = usage_platform_version.date_day\n        and reporting_grain.app_id = usage_platform_version.app_id \n        and reporting_grain.source_type = usage_platform_version.source_type\n        and reporting_grain.platform_version = usage_platform_version.platform_version\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__platform_version_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.101728Z", "completed_at": "2024-03-13T14:21:22.154690Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.166815Z", "completed_at": "2024-03-13T14:21:22.166823Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06884288787841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__app_version_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__crashes_app_version as (\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_app_version\"\n),\n\naggregated as (\n\n    select \n        date_day, \n        app_id,\n        app_version,\n        cast(null as TEXT) as source_type,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3,4\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\ncrashes_app_version_report as (\n    \n    select *\n    from __dbt__cte__int_apple_store__crashes_app_version\n),\n\nusage_app_version_report as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_app_version\"\n),\n\nreporting_grain_combined as (\n    \n    select\n        date_day,\n        app_id,\n        source_type,\n        app_version\n    from usage_app_version_report\n    union all \n    select \n        date_day,\n        app_id,\n        source_type,\n        app_version\n    from crashes_app_version_report\n),\n\nreporting_grain as (\n\n    select \n        distinct *\n    from reporting_grain_combined\n),\n\njoined as (\n\n    select \n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.app_version,\n        coalesce(crashes_app_version_report.crashes, 0) as crashes,\n        coalesce(usage_app_version_report.active_devices, 0) as active_devices,\n        coalesce(usage_app_version_report.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_app_version_report.deletions, 0) as deletions,\n        coalesce(usage_app_version_report.installations, 0) as installations,\n        coalesce(usage_app_version_report.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n    left join crashes_app_version_report\n        on reporting_grain.date_day = crashes_app_version_report.date_day\n        and reporting_grain.app_id = crashes_app_version_report.app_id\n        and reporting_grain.source_type = crashes_app_version_report.source_type\n        and reporting_grain.app_version = crashes_app_version_report.app_version\n    left join usage_app_version_report\n        on reporting_grain.date_day = usage_app_version_report.date_day\n        and reporting_grain.app_id = usage_app_version_report.app_id \n        and reporting_grain.source_type = usage_app_version_report.source_type\n        and reporting_grain.app_version = usage_app_version_report.app_version\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__app_version_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.113747Z", "completed_at": "2024-03-13T14:21:22.161939Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.168380Z", "completed_at": "2024-03-13T14:21:22.168384Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07000088691711426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__device_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__crashes_device as (\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_app_version\"\n),\n\naggregated as (\n\n    select \n        date_day, \n        app_id,\n        device,\n        cast(null as TEXT) as source_type,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3,4\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__subscription_device as (\n\n\nwith app as (\n    \n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\nsubscription_summary as (\n\n    select\n        date_day,\n        app_name,\n        device,\n        sum(active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_summary\"\n    group by 1,2,3\n), \n\nfiltered_subscription_events as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_events\" \n    where lower(event)\n        in (\n            \n                \n                'renew'\n            \n                \n                , \n                \n                'cancel'\n            \n                \n                , \n                \n                'subscribe'\n               \n        )\n),\n\npivoted_subscription_events as (\n    \n    select\n        date_day\n        , app_name\n        , device\n        \n        , sum(case when lower(event) = 'renew' then quantity else 0 end) as event_renew\n        \n        , sum(case when lower(event) = 'cancel' then quantity else 0 end) as event_cancel\n        \n        , sum(case when lower(event) = 'subscribe' then quantity else 0 end) as event_subscribe\n        \n    from filtered_subscription_events\n    group by 1,2,3\n),\n\njoined as (\n\n    select \n        app.app_id,\n        pivoted_subscription_events.*,\n        subscription_summary.active_free_trial_introductory_offer_subscriptions,\n        subscription_summary.active_pay_as_you_go_introductory_offer_subscriptions,\n        subscription_summary.active_pay_up_front_introductory_offer_subscriptions,\n        subscription_summary.active_standard_price_subscriptions,\n        cast(null as TEXT) as source_type\n    from subscription_summary \n    left join pivoted_subscription_events\n        on subscription_summary.date_day = pivoted_subscription_events.date_day\n        and subscription_summary.app_name = pivoted_subscription_events.app_name\n        and subscription_summary.device = pivoted_subscription_events.device\n    left join app \n        on subscription_summary.app_name = app.app_name\n)\n\nselect * \nfrom joined\n), app as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\napp_store_device as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_device\"\n),\n\ndownloads_device as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_device\"\n),\n\nusage_device as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_device\"\n),\n\ncrashes_device as (\n\n    select *\n    from __dbt__cte__int_apple_store__crashes_device\n),\n\n\nsubscription_device as (\n\n    select *\n    from __dbt__cte__int_apple_store__subscription_device\n),\n\n\nreporting_grain_combined as (\n\n    select\n        date_day,\n        app_id,\n        source_type,\n        device \n    from app_store_device\n    union all\n    select\n        date_day,\n        app_id,\n        source_type,\n        device\n    from crashes_device\n),\n\nreporting_grain as (\n    \n    select\n        distinct *\n    from reporting_grain_combined\n),\n\njoined as (\n\n    select \n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.device,\n        coalesce(app_store_device.impressions, 0) as impressions,\n        coalesce(app_store_device.impressions_unique_device, 0) as impressions_unique_device,\n        coalesce(app_store_device.page_views, 0) as page_views,\n        coalesce(app_store_device.page_views_unique_device, 0) as page_views_unique_device,\n        coalesce(crashes_device.crashes, 0) as crashes,\n        coalesce(downloads_device.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_device.redownloads, 0) as redownloads,\n        coalesce(downloads_device.total_downloads, 0) as total_downloads,\n        coalesce(usage_device.active_devices, 0) as active_devices,\n        coalesce(usage_device.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_device.deletions, 0) as deletions,\n        coalesce(usage_device.installations, 0) as installations,\n        coalesce(usage_device.sessions, 0) as sessions\n        \n        ,\n        coalesce(subscription_device.active_free_trial_introductory_offer_subscriptions, 0) as active_free_trial_introductory_offer_subscriptions,\n        coalesce(subscription_device.active_pay_as_you_go_introductory_offer_subscriptions, 0) as active_pay_a_you_go_introductory_offer_subscriptions,\n        coalesce(subscription_device.active_pay_up_front_introductory_offer_subscriptions, 0) as active_pay_up_front_introductory_offer_subscriptions,\n        coalesce(subscription_device.active_standard_price_subscriptions, 0) as active_standard_price_subscriptions\n        \n        \n        , coalesce(subscription_device.event_renew, 0)\n            as event_renew \n        \n        \n        , coalesce(subscription_device.event_cancel, 0)\n            as event_cancel \n        \n        \n        , coalesce(subscription_device.event_subscribe, 0)\n            as event_subscribe \n        \n        \n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n    left join app_store_device \n        on reporting_grain.date_day = app_store_device.date_day\n        and reporting_grain.app_id = app_store_device.app_id \n        and reporting_grain.source_type = app_store_device.source_type\n        and reporting_grain.device = app_store_device.device\n    left join crashes_device\n        on reporting_grain.date_day = crashes_device.date_day\n        and reporting_grain.app_id = crashes_device.app_id\n        and reporting_grain.source_type = crashes_device.source_type\n        and reporting_grain.device = crashes_device.device\n    left join downloads_device\n        on reporting_grain.date_day = downloads_device.date_day\n        and reporting_grain.app_id = downloads_device.app_id \n        and reporting_grain.source_type = downloads_device.source_type\n        and reporting_grain.device = downloads_device.device\n    \n    left join subscription_device\n        on reporting_grain.date_day = subscription_device.date_day\n        and reporting_grain.app_id = subscription_device.app_id \n        and reporting_grain.source_type = subscription_device.source_type\n        and reporting_grain.device = subscription_device.device\n    \n    left join usage_device\n        on reporting_grain.date_day = usage_device.date_day\n        and reporting_grain.app_id = usage_device.app_id \n        and reporting_grain.source_type = usage_device.source_type\n        and reporting_grain.device = usage_device.device\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__device_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.137195Z", "completed_at": "2024-03-13T14:21:22.166550Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.168957Z", "completed_at": "2024-03-13T14:21:22.168962Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07006692886352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__subscription_report", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_apple_store__sales_subscription_summary as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_summary\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_account\"\n),\n\njoined as (\n\n    select \n        base.date_day,\n        base.account_id,\n        sales_account.account_name,\n        app.app_id,\n        base.app_name,\n        base.subscription_name,\n        base.country,\n        base.state,\n        sum(base.active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(base.active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(base.active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(base.active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from base\n    left join app \n        on base.app_name = app.app_name\n    left join sales_account \n        on base.account_id = sales_account.account_id\n    group by 1,2,3,4,5,6,7,8\n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__sales_subscription_events as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_events\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_account\"\n),\n\nfiltered as (\n\n    select *\n    from base \n    where lower(event)\n        in (\n            \n                \n                'renew'\n            \n                \n                , \n                \n                'cancel'\n            \n                \n                , \n                \n                'subscribe'\n               \n        )\n),\n\npivoted as (\n    \n    select\n        date_day\n        , account_id\n        , app_name\n        , subscription_name\n        , country\n        , state\n        \n        , sum(case when lower(event) = 'renew' then quantity else 0 end) as event_renew\n        \n        , sum(case when lower(event) = 'cancel' then quantity else 0 end) as event_cancel\n        \n        , sum(case when lower(event) = 'subscribe' then quantity else 0 end) as event_subscribe\n        \n    from filtered\n    group by 1,2,3,4,5,6\n),\n\njoined as (\n\n    select \n        pivoted.date_day,\n        pivoted.account_id,\n        sales_account.account_name,\n        app.app_id,\n        pivoted.app_name,\n        pivoted.subscription_name,\n        pivoted.country,\n        pivoted.state\n        \n        , pivoted.event_renew\n        \n        , pivoted.event_cancel\n        \n        , pivoted.event_subscribe\n        \n    from pivoted\n    left join app \n        on pivoted.app_name = app.app_name\n    left join sales_account \n        on pivoted.account_id = sales_account.account_id\n)\n\nselect * \nfrom joined\n), subscription_summary as (\n\n    select *\n    from __dbt__cte__int_apple_store__sales_subscription_summary\n),\n\nsubscription_events as (\n\n    select *\n    from __dbt__cte__int_apple_store__sales_subscription_events\n),\n\ncountry_codes as (\n    \n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"apple_store_country_codes\"\n),\n\nreporting_grain_combined as (\n\n    select\n        cast(date_day as date) as date_day,\n        account_id,\n        account_name,\n        app_name,\n        app_id,\n        subscription_name,\n        country,\n        state \n    from subscription_summary\n    union all\n    select\n        cast(date_day as date) as date_day,\n        account_id,\n        account_name,\n        app_name,\n        app_id,\n        subscription_name,\n        country,\n        state \n    from subscription_events\n),\n\nreporting_grain as (\n\n    select \n        distinct *\n    from reporting_grain_combined\n),\n\njoined as (\n\n    select \n        reporting_grain.date_day,\n        reporting_grain.account_id,\n        reporting_grain.account_name, \n        reporting_grain.app_id,\n        reporting_grain.app_name,\n        reporting_grain.subscription_name, \n        case \n            when country_codes.alternative_country_name is null then country_codes.country_name\n            else country_codes.alternative_country_name\n        end as territory_long,\n        reporting_grain.country as territory_short,\n        reporting_grain.state,\n        country_codes.region, \n        country_codes.sub_region,\n        coalesce(subscription_summary.active_free_trial_introductory_offer_subscriptions, 0) as active_free_trial_introductory_offer_subscriptions,\n        coalesce(subscription_summary.active_pay_as_you_go_introductory_offer_subscriptions, 0) as active_pay_as_you_go_introductory_offer_subscriptions,\n        coalesce(subscription_summary.active_pay_up_front_introductory_offer_subscriptions, 0) as active_pay_up_front_introductory_offer_subscriptions,\n        coalesce(subscription_summary.active_standard_price_subscriptions, 0) as active_standard_price_subscriptions\n        \n        \n        , coalesce(subscription_events.event_renew, 0)\n            as event_renew \n        \n        \n        , coalesce(subscription_events.event_cancel, 0)\n            as event_cancel \n        \n        \n        , coalesce(subscription_events.event_subscribe, 0)\n            as event_subscribe \n        \n    from reporting_grain\n    left join subscription_summary\n        on reporting_grain.date_day = subscription_summary.date_day\n        and reporting_grain.account_id =  subscription_summary.account_id \n        and reporting_grain.app_name = subscription_summary.app_name\n        and reporting_grain.subscription_name = subscription_summary.subscription_name\n        and reporting_grain.country = subscription_summary.country\n        and (reporting_grain.state = subscription_summary.state or (reporting_grain.state is null and subscription_summary.state is null))\n    left join subscription_events\n        on reporting_grain.date_day = subscription_events.date_day\n        and reporting_grain.account_id =  subscription_events.account_id \n        and reporting_grain.app_name = subscription_events.app_name\n        and reporting_grain.subscription_name = subscription_events.subscription_name\n        and reporting_grain.country = subscription_events.country\n        and (reporting_grain.state = subscription_events.state or (reporting_grain.state is null and subscription_events.state is null))\n    left join country_codes\n        on reporting_grain.country = country_codes.country_code_alpha_2\n    \n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__subscription_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.173582Z", "completed_at": "2024-03-13T14:21:22.194794Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.195652Z", "completed_at": "2024-03-13T14:21:22.195659Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02589702606201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__source_type_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__app_store_source_type as (\nwith base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_device\"\n),\n\naggregated as (\n\n    select \n        date_day,\n        app_id,\n        source_type,\n        sum(impressions) as impressions,\n        sum(page_views) as page_views\n    from base \n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__downloads_source_type as (\nwith base as (\n    \n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_device\"\n),\n\naggregated as (\n\n    select \n        date_day,\n        app_id,\n        source_type,\n        sum(first_time_downloads) as first_time_downloads,\n        sum(redownloads) as redownloads,\n        sum(total_downloads) as total_downloads\n    from base \n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__usage_source_type as (\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_device\"\n),\n\naggregated as (\n\n    select \n        date_day,\n        app_id,\n        source_type,\n        sum(active_devices) as active_devices,\n        sum(deletions) as deletions,\n        sum(installations) as installations,\n        sum(sessions) as sessions\n    from base\n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\napp_store_source_type as (\n\n    select *\n    from __dbt__cte__int_apple_store__app_store_source_type\n),\n\ndownloads_source_type as (\n\n    select *\n    from __dbt__cte__int_apple_store__downloads_source_type\n),\n\nusage_source_type as (\n\n    select *\n    from __dbt__cte__int_apple_store__usage_source_type\n),\n\nreporting_grain as (\n\n    select distinct\n        date_day,\n        app_id,\n        source_type\n    from app_store_source_type\n),\n\njoined as (\n\n    select \n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        coalesce(app_store_source_type.impressions, 0) as impressions,\n        coalesce(app_store_source_type.page_views, 0) as page_views,\n        coalesce(downloads_source_type.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_source_type.redownloads, 0) as redownloads,\n        coalesce(downloads_source_type.total_downloads, 0) as total_downloads,\n        coalesce(usage_source_type.active_devices, 0) as active_devices,\n        coalesce(usage_source_type.deletions, 0) as deletions,\n        coalesce(usage_source_type.installations, 0) as installations,\n        coalesce(usage_source_type.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n    left join app_store_source_type\n        on reporting_grain.date_day = app_store_source_type.date_day\n        and reporting_grain.app_id = app_store_source_type.app_id \n        and reporting_grain.source_type = app_store_source_type.source_type\n    left join downloads_source_type\n        on reporting_grain.date_day = downloads_source_type.date_day\n        and reporting_grain.app_id = downloads_source_type.app_id \n        and reporting_grain.source_type = downloads_source_type.source_type\n    left join usage_source_type\n        on reporting_grain.date_day = usage_source_type.date_day\n        and reporting_grain.app_id = usage_source_type.app_id \n        and reporting_grain.source_type = usage_source_type.source_type\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__source_type_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.185660Z", "completed_at": "2024-03-13T14:21:22.196029Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.198724Z", "completed_at": "2024-03-13T14:21:22.198729Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02770709991455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__territory_report_date_day__app_id__source_type__territory_long.9a1eb640a6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, territory_long\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__territory_report\"\n    group by date_day, app_id, source_type, territory_long\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.191324Z", "completed_at": "2024-03-13T14:21:22.196409Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.199044Z", "completed_at": "2024-03-13T14:21:22.199047Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.027458906173706055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__app_version_report_date_day__app_id__source_type__app_version.de63f831ca", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, app_version\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__app_version_report\"\n    group by date_day, app_id, source_type, app_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.188753Z", "completed_at": "2024-03-13T14:21:22.197277Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.199725Z", "completed_at": "2024-03-13T14:21:22.199729Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02862715721130371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__platform_version_report_date_day__app_id__source_type__platform_version.a14b116d68", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, platform_version\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__platform_version_report\"\n    group by date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.202398Z", "completed_at": "2024-03-13T14:21:22.243342Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.267264Z", "completed_at": "2024-03-13T14:21:22.267272Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06912684440612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__device_report_date_day__app_id__source_type__device.d5cfe96996", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type, device\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__device_report\"\n    group by date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.260833Z", "completed_at": "2024-03-13T14:21:22.266937Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.269276Z", "completed_at": "2024-03-13T14:21:22.269281Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.028600215911865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__subscription_report_date_day__account_id__app_id__subscription_name__territory_long__state.c29f4d07e9", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, account_id, app_id, subscription_name, territory_long, state\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__subscription_report\"\n    group by date_day, account_id, app_id, subscription_name, territory_long, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.263860Z", "completed_at": "2024-03-13T14:21:22.267523Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.269622Z", "completed_at": "2024-03-13T14:21:22.269625Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.028685808181762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__source_type_report_date_day__app_id__source_type.75593c9092", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id, source_type\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__source_type_report\"\n    group by date_day, app_id, source_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.243629Z", "completed_at": "2024-03-13T14:21:22.267770Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.269898Z", "completed_at": "2024-03-13T14:21:22.269901Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.030112028121948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__overview_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__app_store_overview as (\nwith base as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app_store_device\"\n),\n\naggregated as (\n\n    select \n        date_day,\n        app_id,\n        sum(impressions) as impressions,\n        sum(page_views) as page_views\n    from base \n    group by 1,2\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__crashes_overview as (\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__crashes_app_version\"\n),\n\naggregated as (\n\n    select \n        date_day, \n        app_id,\n        sum(crashes) as crashes\n    from base\n    group by 1,2\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__downloads_overview as (\nwith base as (\n    \n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__downloads_device\"\n),\n\naggregated as (\n\n    select \n        date_day,\n        app_id,\n        sum(first_time_downloads) as first_time_downloads,\n        sum(redownloads) as redownloads,\n        sum(total_downloads) as total_downloads\n    from base \n    group by 1,2\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__sales_subscription_summary as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_summary\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_account\"\n),\n\njoined as (\n\n    select \n        base.date_day,\n        base.account_id,\n        sales_account.account_name,\n        app.app_id,\n        base.app_name,\n        base.subscription_name,\n        base.country,\n        base.state,\n        sum(base.active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(base.active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(base.active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(base.active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from base\n    left join app \n        on base.app_name = app.app_name\n    left join sales_account \n        on base.account_id = sales_account.account_id\n    group by 1,2,3,4,5,6,7,8\n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__sales_subscription_events as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_subscription_events\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__sales_account\"\n),\n\nfiltered as (\n\n    select *\n    from base \n    where lower(event)\n        in (\n            \n                \n                'renew'\n            \n                \n                , \n                \n                'cancel'\n            \n                \n                , \n                \n                'subscribe'\n               \n        )\n),\n\npivoted as (\n    \n    select\n        date_day\n        , account_id\n        , app_name\n        , subscription_name\n        , country\n        , state\n        \n        , sum(case when lower(event) = 'renew' then quantity else 0 end) as event_renew\n        \n        , sum(case when lower(event) = 'cancel' then quantity else 0 end) as event_cancel\n        \n        , sum(case when lower(event) = 'subscribe' then quantity else 0 end) as event_subscribe\n        \n    from filtered\n    group by 1,2,3,4,5,6\n),\n\njoined as (\n\n    select \n        pivoted.date_day,\n        pivoted.account_id,\n        sales_account.account_name,\n        app.app_id,\n        pivoted.app_name,\n        pivoted.subscription_name,\n        pivoted.country,\n        pivoted.state\n        \n        , pivoted.event_renew\n        \n        , pivoted.event_cancel\n        \n        , pivoted.event_subscribe\n        \n    from pivoted\n    left join app \n        on pivoted.app_name = app.app_name\n    left join sales_account \n        on pivoted.account_id = sales_account.account_id\n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__sales_subscription_overview as (\n\n\nwith subscription_summary as (\n\n    select\n        date_day,\n        app_id,\n        sum(active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from __dbt__cte__int_apple_store__sales_subscription_summary\n    group by 1,2\n), \n\nsubscription_events as (\n\n    select \n        date_day,\n        app_id\n        \n        \n        , coalesce(sum(event_renew), 0)\n            as event_renew \n        \n        \n        , coalesce(sum(event_cancel), 0)\n            as event_cancel \n        \n        \n        , coalesce(sum(event_subscribe), 0)\n            as event_subscribe \n        \n    from __dbt__cte__int_apple_store__sales_subscription_events\n    group by 1,2\n), \n\njoined as (\n\n    select \n        subscription_events.*,\n        active_free_trial_introductory_offer_subscriptions,\n        active_pay_as_you_go_introductory_offer_subscriptions,\n        active_pay_up_front_introductory_offer_subscriptions,\n        active_standard_price_subscriptions\n    from subscription_summary \n    left join subscription_events\n        on subscription_summary.date_day = subscription_events.date_day\n        and subscription_summary.app_id = subscription_events.app_id \n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__usage_overview as (\nwith base as (\n\n    select *\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__usage_device\"\n),\n\naggregated as (\n\n    select \n        date_day,\n        app_id,\n        sum(active_devices) as active_devices,\n        sum(deletions) as deletions,\n        sum(installations) as installations,\n        sum(sessions) as sessions\n    from base\n    group by 1,2\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"apple_store_integration_tests_6_apple_store_source\".\"stg_apple_store__app\"\n),\n\napp_store as (\n\n    select *\n    from __dbt__cte__int_apple_store__app_store_overview\n),\n\ncrashes as (\n\n    select *\n    from __dbt__cte__int_apple_store__crashes_overview\n),\n\ndownloads as (\n\n    select *\n    from __dbt__cte__int_apple_store__downloads_overview\n),\n\n\nsubscriptions as (\n\n    select *\n    from __dbt__cte__int_apple_store__sales_subscription_overview\n), \n\n\nusage as (\n\n    select *\n    from __dbt__cte__int_apple_store__usage_overview\n),\n\nreporting_grain as (\n\n    select distinct\n        date_day,\n        app_id \n    from app_store\n), \n\njoined as (\n\n    select \n        reporting_grain.date_day,\n        reporting_grain.app_id,\n        app.app_name,\n        coalesce(app_store.impressions, 0) as impressions,\n        coalesce(app_store.page_views, 0) as page_views,\n        coalesce(crashes.crashes,0) as crashes,\n        coalesce(downloads.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads.redownloads, 0) as redownloads,\n        coalesce(downloads.total_downloads, 0) as total_downloads,\n        coalesce(usage.active_devices, 0) as active_devices,\n        coalesce(usage.deletions, 0) as deletions,\n        coalesce(usage.installations, 0) as installations,\n        coalesce(usage.sessions, 0) as sessions\n        \n        ,\n        coalesce(subscriptions.active_free_trial_introductory_offer_subscriptions, 0) as active_free_trial_introductory_offer_subscriptions,\n        coalesce(subscriptions.active_pay_as_you_go_introductory_offer_subscriptions, 0) as active_pay_as_you_go_introductory_offer_subscriptions,\n        coalesce(subscriptions.active_pay_up_front_introductory_offer_subscriptions, 0) as active_pay_up_front_introductory_offer_subscriptions,\n        coalesce(subscriptions.active_standard_price_subscriptions, 0) as active_standard_price_subscriptions\n        \n        \n        , coalesce(subscriptions.event_renew, 0)\n            as event_renew \n        \n        \n        , coalesce(subscriptions.event_cancel, 0)\n            as event_cancel \n        \n        \n        , coalesce(subscriptions.event_subscribe, 0)\n            as event_subscribe \n        \n        \n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n    left join app_store \n        on reporting_grain.date_day = app_store.date_day\n        and reporting_grain.app_id = app_store.app_id\n    left join crashes\n        on reporting_grain.date_day = crashes.date_day\n        and reporting_grain.app_id = crashes.app_id\n    left join downloads\n        on reporting_grain.date_day = downloads.date_day\n        and reporting_grain.app_id = downloads.app_id\n    \n    left join subscriptions \n        on reporting_grain.date_day = subscriptions.date_day\n        and reporting_grain.app_id = subscriptions.app_id\n    \n    left join usage\n        on reporting_grain.date_day = usage.date_day\n        and reporting_grain.app_id = usage.app_id        \n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__overview_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-13T14:21:22.272877Z", "completed_at": "2024-03-13T14:21:22.276936Z"}, {"name": "execute", "started_at": "2024-03-13T14:21:22.277441Z", "completed_at": "2024-03-13T14:21:22.277447Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005589008331298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__overview_report_date_day__app_id.1301a19968", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        date_day, app_id\n    from \"postgres\".\"apple_store_integration_tests_6_apple_store\".\"apple_store__overview_report\"\n    group by date_day, app_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}], "elapsed_time": 2.9081552028656006, "args": {"profiles_dir": "/Users/joseph.markiewicz/.dbt", "log_format_file": "debug", "cache_selected_only": false, "exclude": [], "log_level_file": "debug", "use_colors_file": true, "write_json": true, "use_colors": true, "static_parser": true, "vars": {}, "static": false, "populate_cache": true, "favor_state": false, "invocation_command": "dbt docs generate -t postgres", "log_level": "info", "select": [], "which": "generate", "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "print": true, "strict_mode": false, "quiet": false, "printer_width": 80, "version_check": true, "macro_debugging": false, "compile": true, "indirect_selection": "eager", "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "log_path": "/Users/joseph.markiewicz/Documents/dbt_packages/apple_store/dbt_apple_store/integration_tests/logs", "defer": false, "show_resource_report": false, "enable_legacy_logger": false, "empty_catalog": false, "project_dir": "/Users/joseph.markiewicz/Documents/dbt_packages/apple_store/dbt_apple_store/integration_tests", "target": "postgres", "partial_parse": true, "introspect": true, "log_format": "default"}}