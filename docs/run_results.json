{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.3", "generated_at": "2024-07-17T23:30:46.175695Z", "invocation_id": "fffde74e-6748-4827-9d10-fc83bfe8ff9d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.012330Z", "completed_at": "2024-07-17T23:30:44.062350Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.063868Z", "completed_at": "2024-07-17T23:30:44.063879Z"}], "thread_id": "Thread-1", "execution_time": 0.058524131774902344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_device_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"app_store_source_type_device\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.041761Z", "completed_at": "2024-07-17T23:30:44.062652Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.064548Z", "completed_at": "2024-07-17T23:30:44.064552Z"}], "thread_id": "Thread-2", "execution_time": 0.05717587471008301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_platform_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"app_store_platform_version_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.045602Z", "completed_at": "2024-07-17T23:30:44.062971Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.065155Z", "completed_at": "2024-07-17T23:30:44.065159Z"}], "thread_id": "Thread-3", "execution_time": 0.05631113052368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_territory_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"app_store_territory_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.053726Z", "completed_at": "2024-07-17T23:30:44.063332Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.065701Z", "completed_at": "2024-07-17T23:30:44.065705Z"}], "thread_id": "Thread-6", "execution_time": 0.055674076080322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_platform_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"crashes_platform_version\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.050988Z", "completed_at": "2024-07-17T23:30:44.063538Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.066058Z", "completed_at": "2024-07-17T23:30:44.066061Z"}], "thread_id": "Thread-5", "execution_time": 0.05642294883728027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_app_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"crashes_app_version\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.048282Z", "completed_at": "2024-07-17T23:30:44.064318Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.066704Z", "completed_at": "2024-07-17T23:30:44.066708Z"}], "thread_id": "Thread-4", "execution_time": 0.057480812072753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"app\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.056485Z", "completed_at": "2024-07-17T23:30:44.064936Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.067379Z", "completed_at": "2024-07-17T23:30:44.067383Z"}], "thread_id": "Thread-7", "execution_time": 0.056653738021850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_device_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"downloads_source_type_device\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.059801Z", "completed_at": "2024-07-17T23:30:44.065501Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.068018Z", "completed_at": "2024-07-17T23:30:44.068021Z"}], "thread_id": "Thread-8", "execution_time": 0.05659008026123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_platform_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"downloads_platform_version_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.072545Z", "completed_at": "2024-07-17T23:30:44.091395Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.094647Z", "completed_at": "2024-07-17T23:30:44.094652Z"}], "thread_id": "Thread-1", "execution_time": 0.025816917419433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_territory_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"downloads_territory_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.075268Z", "completed_at": "2024-07-17T23:30:44.094052Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.095714Z", "completed_at": "2024-07-17T23:30:44.095717Z"}], "thread_id": "Thread-2", "execution_time": 0.026355981826782227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_account_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"sales_account\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.077899Z", "completed_at": "2024-07-17T23:30:44.094288Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.096080Z", "completed_at": "2024-07-17T23:30:44.096084Z"}], "thread_id": "Thread-3", "execution_time": 0.026217937469482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_events_tmp", "compiled": true, "compiled_code": "\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"sales_subscription_events\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.080731Z", "completed_at": "2024-07-17T23:30:44.095025Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.097065Z", "completed_at": "2024-07-17T23:30:44.097069Z"}], "thread_id": "Thread-6", "execution_time": 0.0267488956451416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_summary_tmp", "compiled": true, "compiled_code": "\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"sales_subscription_summary\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.084041Z", "completed_at": "2024-07-17T23:30:44.095245Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.097452Z", "completed_at": "2024-07-17T23:30:44.097456Z"}], "thread_id": "Thread-5", "execution_time": 0.02687692642211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_app_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"usage_app_version_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.086452Z", "completed_at": "2024-07-17T23:30:44.095461Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.097803Z", "completed_at": "2024-07-17T23:30:44.097806Z"}], "thread_id": "Thread-4", "execution_time": 0.026805877685546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_device_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"usage_source_type_device\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.088893Z", "completed_at": "2024-07-17T23:30:44.096408Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.098655Z", "completed_at": "2024-07-17T23:30:44.098658Z"}], "thread_id": "Thread-7", "execution_time": 0.027268171310424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_platform_version_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"usage_platform_version_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.091612Z", "completed_at": "2024-07-17T23:30:44.096825Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.099257Z", "completed_at": "2024-07-17T23:30:44.099260Z"}], "thread_id": "Thread-8", "execution_time": 0.027366161346435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_territory_tmp", "compiled": true, "compiled_code": "\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"zz_apple_store\".\"usage_territory_source_type\"", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.102830Z", "completed_at": "2024-07-17T23:30:44.104052Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.108661Z", "completed_at": "2024-07-17T23:30:44.108665Z"}], "thread_id": "Thread-1", "execution_time": 0.009703874588012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.105057Z", "completed_at": "2024-07-17T23:30:44.106914Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.113135Z", "completed_at": "2024-07-17T23:30:44.113138Z"}], "thread_id": "Thread-2", "execution_time": 0.012814044952392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app_store_platform_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.107128Z", "completed_at": "2024-07-17T23:30:44.108257Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.113481Z", "completed_at": "2024-07-17T23:30:44.113485Z"}], "thread_id": "Thread-3", "execution_time": 0.012887001037597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app_store_source_type_device", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.109213Z", "completed_at": "2024-07-17T23:30:44.110332Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.117269Z", "completed_at": "2024-07-17T23:30:44.117273Z"}], "thread_id": "Thread-6", "execution_time": 0.015765905380249023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.app_store_territory_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.110531Z", "completed_at": "2024-07-17T23:30:44.111617Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.117621Z", "completed_at": "2024-07-17T23:30:44.117625Z"}], "thread_id": "Thread-5", "execution_time": 0.015865087509155273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.crashes_app_version", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.111812Z", "completed_at": "2024-07-17T23:30:44.112931Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.117946Z", "completed_at": "2024-07-17T23:30:44.117949Z"}], "thread_id": "Thread-4", "execution_time": 0.01596522331237793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.crashes_platform_version", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.113803Z", "completed_at": "2024-07-17T23:30:44.115515Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.118710Z", "completed_at": "2024-07-17T23:30:44.118714Z"}], "thread_id": "Thread-7", "execution_time": 0.016143083572387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.downloads_platform_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.115944Z", "completed_at": "2024-07-17T23:30:44.117053Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.119258Z", "completed_at": "2024-07-17T23:30:44.119261Z"}], "thread_id": "Thread-8", "execution_time": 0.015053033828735352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.downloads_source_type_device", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.122460Z", "completed_at": "2024-07-17T23:30:44.123597Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.127336Z", "completed_at": "2024-07-17T23:30:44.127339Z"}], "thread_id": "Thread-1", "execution_time": 0.00835108757019043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.downloads_territory_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.124557Z", "completed_at": "2024-07-17T23:30:44.125666Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.132417Z", "completed_at": "2024-07-17T23:30:44.132421Z"}], "thread_id": "Thread-2", "execution_time": 0.01224207878112793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.sales_account", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.125858Z", "completed_at": "2024-07-17T23:30:44.126961Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.132744Z", "completed_at": "2024-07-17T23:30:44.132748Z"}], "thread_id": "Thread-3", "execution_time": 0.012338876724243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.sales_subscription_events", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.127847Z", "completed_at": "2024-07-17T23:30:44.128981Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.135853Z", "completed_at": "2024-07-17T23:30:44.135857Z"}], "thread_id": "Thread-6", "execution_time": 0.014637947082519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.sales_subscription_summary", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.129173Z", "completed_at": "2024-07-17T23:30:44.130945Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.136179Z", "completed_at": "2024-07-17T23:30:44.136182Z"}], "thread_id": "Thread-5", "execution_time": 0.014729976654052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_app_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.131144Z", "completed_at": "2024-07-17T23:30:44.132228Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.136496Z", "completed_at": "2024-07-17T23:30:44.136499Z"}], "thread_id": "Thread-4", "execution_time": 0.014847993850708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_platform_version_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.133064Z", "completed_at": "2024-07-17T23:30:44.134149Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.137257Z", "completed_at": "2024-07-17T23:30:44.137260Z"}], "thread_id": "Thread-7", "execution_time": 0.015052080154418945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_source_type_device", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.134554Z", "completed_at": "2024-07-17T23:30:44.135641Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.137774Z", "completed_at": "2024-07-17T23:30:44.137777Z"}], "thread_id": "Thread-8", "execution_time": 0.014024019241333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_integration_tests.usage_territory_source_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.140928Z", "completed_at": "2024-07-17T23:30:44.142087Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.159503Z", "completed_at": "2024-07-17T23:30:44.159509Z"}], "thread_id": "Thread-1", "execution_time": 0.022001028060913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.apple_store_source.apple_store_country_codes", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.205818Z", "completed_at": "2024-07-17T23:30:44.896380Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.897287Z", "completed_at": "2024-07-17T23:30:44.897294Z"}], "thread_id": "Thread-8", "execution_time": 0.8122868537902832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_device", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    first_time_downloads\n    \n as \n    \n    first_time_downloads\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    redownloads\n    \n as \n    \n    redownloads\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    total_downloads\n    \n as \n    \n    total_downloads\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(device as TEXT) as device,\n        cast(first_time_downloads as bigint) as first_time_downloads,\n        cast(redownloads as bigint) as redownloads,\n        cast(total_downloads as bigint) as total_downloads\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.160061Z", "completed_at": "2024-07-17T23:30:44.896699Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.897581Z", "completed_at": "2024-07-17T23:30:44.897585Z"}], "thread_id": "Thread-6", "execution_time": 0.8226120471954346, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_territory", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    impressions_unique_device\n    \n as \n    \n    impressions_unique_device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    page_views\n    \n as \n    \n    page_views\n    \n, \n    \n    \n    page_views_unique_device\n    \n as \n    \n    page_views_unique_device\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    territory\n    \n as \n    \n    territory\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(territory as TEXT) as territory,\n        cast(impressions as bigint) as impressions,\n        cast(impressions_unique_device as bigint) as impressions_unique_device,\n        cast(page_views as bigint) as page_views,\n        cast(page_views_unique_device as bigint) as page_views_unique_device\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.154627Z", "completed_at": "2024-07-17T23:30:44.897050Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:44.897823Z", "completed_at": "2024-07-17T23:30:44.897826Z"}], "thread_id": "Thread-3", "execution_time": 0.836533784866333, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    impressions_unique_device\n    \n as \n    \n    impressions_unique_device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    page_views\n    \n as \n    \n    page_views\n    \n, \n    \n    \n    page_views_unique_device\n    \n as \n    \n    page_views_unique_device\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(platform_version as TEXT) as platform_version,\n        cast(impressions as bigint) as impressions,\n        cast(impressions_unique_device as bigint) as impressions_unique_device,\n        cast(page_views as bigint) as page_views,\n        cast(page_views_unique_device as bigint) as page_views_unique_device\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.165008Z", "completed_at": "2024-07-17T23:30:45.036699Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.037170Z", "completed_at": "2024-07-17T23:30:45.037177Z"}], "thread_id": "Thread-5", "execution_time": 0.9942929744720459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    crashes\n    \n as \n    \n    crashes\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(device as TEXT) as device,\n        cast(platform_version as TEXT) as platform_version,\n        cast(crashes as bigint) as crashes\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.213772Z", "completed_at": "2024-07-17T23:30:45.036946Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.037418Z", "completed_at": "2024-07-17T23:30:45.037422Z"}], "thread_id": "Thread-1", "execution_time": 0.9231469631195068, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    first_time_downloads\n    \n as \n    \n    first_time_downloads\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n, \n    \n    \n    redownloads\n    \n as \n    \n    redownloads\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    total_downloads\n    \n as \n    \n    total_downloads\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(platform_version as TEXT) as platform_version,\n        cast(first_time_downloads as bigint) as first_time_downloads,\n        cast(redownloads as bigint) as redownloads,\n        cast(total_downloads as bigint) as total_downloads\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.169249Z", "completed_at": "2024-07-17T23:30:45.135549Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.136694Z", "completed_at": "2024-07-17T23:30:45.136700Z"}], "thread_id": "Thread-4", "execution_time": 1.0481281280517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__crashes_app_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_version\n    \n as \n    \n    app_version\n    \n, \n    \n    \n    crashes\n    \n as \n    \n    crashes\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(device as TEXT) as device,\n        cast(app_version as TEXT) as app_version,\n        cast(crashes as bigint) as crashes\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.173795Z", "completed_at": "2024-07-17T23:30:45.167804Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.168058Z", "completed_at": "2024-07-17T23:30:45.168063Z"}], "thread_id": "Thread-7", "execution_time": 1.0744588375091553, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_opt_in_rate\n    \n as \n    \n    app_opt_in_rate\n    \n, \n    \n    \n    asset_token\n    \n as \n    \n    asset_token\n    \n, \n    \n    \n    icon_url\n    \n as \n    \n    icon_url\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ios\n    \n as \n    \n    ios\n    \n, \n    \n    \n    is_bundle\n    \n as \n    \n    is_bundle\n    \n, \n    \n    \n    is_enabled\n    \n as \n    \n    is_enabled\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    pre_order_info\n    \n as \n    \n    pre_order_info\n    \n, \n    \n    \n    tvos\n    \n as \n    \n    tvos\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(id as bigint) as app_id,\n        cast(name as TEXT) as app_name,\n        is_enabled\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.143053Z", "completed_at": "2024-07-17T23:30:45.167303Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.167563Z", "completed_at": "2024-07-17T23:30:45.167569Z"}], "thread_id": "Thread-2", "execution_time": 1.0838332176208496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__app_store_device", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    impressions_unique_device\n    \n as \n    \n    impressions_unique_device\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    page_views\n    \n as \n    \n    page_views\n    \n, \n    \n    \n    page_views_unique_device\n    \n as \n    \n    page_views_unique_device\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(device as TEXT) as device,\n        cast(impressions as bigint) as impressions,\n        cast(impressions_unique_device as bigint) as impressions_unique_device,\n        cast(page_views as bigint) as page_views,\n        cast(page_views_unique_device as bigint) as page_views_unique_device\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.976567Z", "completed_at": "2024-07-17T23:30:45.724397Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.726346Z", "completed_at": "2024-07-17T23:30:45.726354Z"}], "thread_id": "Thread-3", "execution_time": 0.8103151321411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_events", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _filename\n    \n as \n    \n    _filename\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _index\n    \n as \n    \n    _index\n    \n, \n    \n    \n    account_number\n    \n as \n    \n    account_number\n    \n, \n    \n    \n    app_apple_id\n    \n as \n    \n    app_apple_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    cancellation_reason\n    \n as \n    \n    cancellation_reason\n    \n, \n    \n    \n    consecutive_paid_periods\n    \n as \n    \n    consecutive_paid_periods\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    days_before_canceling\n    \n as \n    \n    days_before_canceling\n    \n, \n    \n    \n    days_canceled\n    \n as \n    \n    days_canceled\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    event\n    \n as \n    \n    event\n    \n, \n    \n    \n    event_date\n    \n as \n    \n    event_date\n    \n, \n    \n    \n    marketing_opt_in_duration\n    \n as \n    \n    marketing_opt_in_duration\n    \n, \n    \n    \n    original_start_date\n    \n as \n    \n    original_start_date\n    \n, \n    \n    \n    previous_subscription_apple_id\n    \n as \n    \n    previous_subscription_apple_id\n    \n, \n    \n    \n    previous_subscription_name\n    \n as \n    \n    previous_subscription_name\n    \n, \n    \n    \n    proceeds_reason\n    \n as \n    \n    proceeds_reason\n    \n, \n    \n    \n    promotional_offer_id\n    \n as \n    \n    promotional_offer_id\n    \n, \n    \n    \n    promotional_offer_name\n    \n as \n    \n    promotional_offer_name\n    \n, \n    \n    \n    quantity\n    \n as \n    \n    quantity\n    \n, \n    \n    \n    standard_subscription_duration\n    \n as \n    \n    standard_subscription_duration\n    \n, \n    \n    \n    state\n    \n as \n    \n    state\n    \n, \n    \n    \n    subscription_apple_id\n    \n as \n    \n    subscription_apple_id\n    \n, \n    \n    \n    subscription_group_id\n    \n as \n    \n    subscription_group_id\n    \n, \n    \n    \n    subscription_name\n    \n as \n    \n    subscription_name\n    \n, \n    \n    \n    subscription_offer_duration\n    \n as \n    \n    subscription_offer_duration\n    \n, \n    \n    \n    subscription_offer_type\n    \n as \n    \n    subscription_offer_type\n    \n, \n    \n    \n    vendor_number\n    \n as \n    \n    vendor_number\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(event_date as date) as date_day,\n        cast(account_number as bigint) as account_id,\n        cast(app_name as TEXT) as app_name,\n        cast(subscription_name as TEXT) as subscription_name,\n        cast(event as TEXT) as event,\n        cast(country as TEXT) as country,\n        cast(case\n            when replace(state, ' ', '') = '' then cast(null as TEXT) else state\n        end as TEXT) as state,\n        cast(case \n            when lower(device) like 'ipod%' then 'iPod' else device\n        end as TEXT) as device,\n        sum(cast(quantity as bigint)) as quantity\n    from fields\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.963668Z", "completed_at": "2024-07-17T23:30:45.725060Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.726974Z", "completed_at": "2024-07-17T23:30:45.726979Z"}], "thread_id": "Thread-6", "execution_time": 0.8290290832519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_account", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(id as bigint) as account_id,\n        cast(name as TEXT) as account_name\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:44.956097Z", "completed_at": "2024-07-17T23:30:45.726078Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.727342Z", "completed_at": "2024-07-17T23:30:45.727347Z"}], "thread_id": "Thread-8", "execution_time": 0.8371779918670654, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__downloads_territory", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    first_time_downloads\n    \n as \n    \n    first_time_downloads\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    redownloads\n    \n as \n    \n    redownloads\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    territory\n    \n as \n    \n    territory\n    \n, \n    \n    \n    total_downloads\n    \n as \n    \n    total_downloads\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(territory as TEXT) as territory,\n        cast(first_time_downloads as bigint) as first_time_downloads,\n        cast(redownloads as bigint) as redownloads,\n        cast(total_downloads as bigint) as total_downloads\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.798445Z", "completed_at": "2024-07-17T23:30:45.832060Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.833047Z", "completed_at": "2024-07-17T23:30:45.833052Z"}], "thread_id": "Thread-8", "execution_time": 0.03885293006896973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__downloads_device_source_relation__date_day__app_id__source_type__device.0b46c778ff", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, device\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\"\n    group by source_relation, date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.808421Z", "completed_at": "2024-07-17T23:30:45.832272Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.833443Z", "completed_at": "2024-07-17T23:30:45.833447Z"}], "thread_id": "Thread-3", "execution_time": 0.0381169319152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_store_territory_source_relation__date_day__app_id__source_type__territory.d4a759ea32", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, territory\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory\"\n    group by source_relation, date_day, app_id, source_type, territory\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.839789Z", "completed_at": "2024-07-17T23:30:45.850470Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.851649Z", "completed_at": "2024-07-17T23:30:45.851653Z"}], "thread_id": "Thread-6", "execution_time": 0.026123046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_store_platform_version_source_relation__date_day__app_id__source_type__platform_version.f38f8df8b1", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version\"\n    group by source_relation, date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.855358Z", "completed_at": "2024-07-17T23:30:45.862302Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.863022Z", "completed_at": "2024-07-17T23:30:45.863027Z"}], "thread_id": "Thread-3", "execution_time": 0.012393951416015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__crashes_platform_version_source_relation__date_day__app_id__device__platform_version.5bf4ea102a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, device, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version\"\n    group by source_relation, date_day, app_id, device, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.859042Z", "completed_at": "2024-07-17T23:30:45.863390Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.870015Z", "completed_at": "2024-07-17T23:30:45.870019Z"}], "thread_id": "Thread-6", "execution_time": 0.011603832244873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__downloads_platform_version_source_relation__date_day__app_id__source_type__platform_version.b3f49f6945", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version\"\n    group by source_relation, date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.888395Z", "completed_at": "2024-07-17T23:30:45.892639Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.895760Z", "completed_at": "2024-07-17T23:30:45.895764Z"}], "thread_id": "Thread-8", "execution_time": 0.008521080017089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__crashes_app_version_source_relation__date_day__app_id__device__app_version.2cba4b46da", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, device, app_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\"\n    group by source_relation, date_day, app_id, device, app_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.892867Z", "completed_at": "2024-07-17T23:30:45.899035Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.899461Z", "completed_at": "2024-07-17T23:30:45.899466Z"}], "thread_id": "Thread-3", "execution_time": 0.007844209671020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_source_relation__app_id.8b3ebfee12", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, app_id\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n    group by source_relation, app_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.904919Z", "completed_at": "2024-07-17T23:30:45.912682Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.918628Z", "completed_at": "2024-07-17T23:30:45.918633Z"}], "thread_id": "Thread-3", "execution_time": 0.015024900436401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__app_store_device_source_relation__date_day__app_id__source_type__device.019465f61c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, device\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\"\n    group by source_relation, date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.137906Z", "completed_at": "2024-07-17T23:30:45.843176Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.850051Z", "completed_at": "2024-07-17T23:30:45.850056Z"}], "thread_id": "Thread-5", "execution_time": 0.7835288047790527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__sales_subscription_summary", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _filename\n    \n as \n    \n    _filename\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    _index\n    \n as \n    \n    _index\n    \n, \n    \n    \n    account_number\n    \n as \n    \n    account_number\n    \n, \n    \n    \n    active_free_trial_introductory_offer_subscriptions\n    \n as \n    \n    active_free_trial_introductory_offer_subscriptions\n    \n, \n    \n    \n    active_pay_as_you_go_introductory_offer_subscriptions\n    \n as \n    \n    active_pay_as_you_go_introductory_offer_subscriptions\n    \n, \n    \n    \n    active_pay_up_front_introductory_offer_subscriptions\n    \n as \n    \n    active_pay_up_front_introductory_offer_subscriptions\n    \n, \n    \n    \n    active_standard_price_subscriptions\n    \n as \n    \n    active_standard_price_subscriptions\n    \n, \n    \n    \n    app_apple_id\n    \n as \n    \n    app_apple_id\n    \n, \n    \n    \n    app_name\n    \n as \n    \n    app_name\n    \n, \n    \n    \n    billing_retry\n    \n as \n    \n    billing_retry\n    \n, \n    \n    \n    country\n    \n as \n    \n    country\n    \n, \n    \n    \n    customer_currency\n    \n as \n    \n    customer_currency\n    \n, \n    \n    \n    customer_price\n    \n as \n    \n    customer_price\n    \n, \n    \n    \n    developer_proceeds\n    \n as \n    \n    developer_proceeds\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    free_trial_promotional_offer_subscriptions\n    \n as \n    \n    free_trial_promotional_offer_subscriptions\n    \n, \n    \n    \n    grace_period\n    \n as \n    \n    grace_period\n    \n, \n    \n    \n    marketing_opt_ins\n    \n as \n    \n    marketing_opt_ins\n    \n, \n    \n    \n    pay_as_you_go_promotional_offer_subscriptions\n    \n as \n    \n    pay_as_you_go_promotional_offer_subscriptions\n    \n, \n    \n    \n    pay_up_front_promotional_offer_subscriptions\n    \n as \n    \n    pay_up_front_promotional_offer_subscriptions\n    \n, \n    \n    \n    proceeds_currency\n    \n as \n    \n    proceeds_currency\n    \n, \n    \n    \n    proceeds_reason\n    \n as \n    \n    proceeds_reason\n    \n, \n    \n    \n    promotional_offer_id\n    \n as \n    \n    promotional_offer_id\n    \n, \n    \n    \n    promotional_offer_name\n    \n as \n    \n    promotional_offer_name\n    \n, \n    \n    \n    standard_subscription_duration\n    \n as \n    \n    standard_subscription_duration\n    \n, \n    \n    \n    state\n    \n as \n    \n    state\n    \n, \n    \n    \n    subscription_apple_id\n    \n as \n    \n    subscription_apple_id\n    \n, \n    \n    \n    subscription_group_id\n    \n as \n    \n    subscription_group_id\n    \n, \n    \n    \n    subscription_name\n    \n as \n    \n    subscription_name\n    \n, \n    \n    \n    vendor_number\n    \n as \n    \n    vendor_number\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(\n\n    to_date(\n      \n\n  \n    \n\n    split_part(\n        _filename,\n        '_',\n        3\n        )\n\n\n  \n\n, \n      'YYYYMMDD'\n    )\n\n as date) as date_day, \n        cast(app_name as TEXT) as app_name,\n        cast(account_number as bigint) as account_id,\n        cast(country as TEXT) as country,\n        cast(case\n            when replace(state, ' ', '') = '' then cast(null as TEXT) else state\n        end as TEXT) as state,\n        cast(subscription_name as TEXT) as subscription_name,\n        cast(case \n            when lower(device) like 'ipod%' then 'iPod' else device\n        end as TEXT) as device,\n        sum(cast(active_free_trial_introductory_offer_subscriptions as bigint)) as active_free_trial_introductory_offer_subscriptions,\n        sum(cast(active_pay_as_you_go_introductory_offer_subscriptions as bigint)) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(cast(active_pay_up_front_introductory_offer_subscriptions as bigint)) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(cast(active_standard_price_subscriptions as bigint)) as active_standard_price_subscriptions\n    from fields\n    group by 1,2,3,4,5,6,7,8\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.907859Z", "completed_at": "2024-07-17T23:30:45.919025Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.920136Z", "completed_at": "2024-07-17T23:30:45.920139Z"}], "thread_id": "Thread-6", "execution_time": 0.016273021697998047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__sales_subscription_events_source_relation__date_day__account_id__app_name__subscription_name__device__event__country__state.89b9a03f45", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, app_name, subscription_name, device, event, country, state\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\"\n    group by source_relation, date_day, account_id, app_name, subscription_name, device, event, country, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.189598Z", "completed_at": "2024-07-17T23:30:45.850267Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.851223Z", "completed_at": "2024-07-17T23:30:45.851227Z"}], "thread_id": "Thread-4", "execution_time": 0.7321171760559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_device", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(device as TEXT) as device,\n        cast(active_devices as bigint) as active_devices,\n        cast(active_devices_last_30_days as bigint) as active_devices_last_30_days,\n        cast(deletions as bigint) as deletions,\n        cast(installations as bigint) as installations,\n        cast(sessions as bigint) as sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.146819Z", "completed_at": "2024-07-17T23:30:45.851443Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.854861Z", "completed_at": "2024-07-17T23:30:45.854865Z"}], "thread_id": "Thread-1", "execution_time": 0.7899379730224609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_app_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    app_version\n    \n as \n    \n    app_version\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(app_version as TEXT) as app_version,\n        cast(active_devices as bigint) as active_devices,\n        cast(active_devices_last_30_days as bigint) as active_devices_last_30_days,\n        cast(deletions as bigint) as deletions,\n        cast(installations as bigint) as installations,\n        cast(sessions as bigint) as sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.224586Z", "completed_at": "2024-07-17T23:30:45.879722Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.880786Z", "completed_at": "2024-07-17T23:30:45.880790Z"}], "thread_id": "Thread-2", "execution_time": 0.754709005355835, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_territory", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n, \n    \n    \n    territory\n    \n as \n    \n    territory\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(territory as TEXT) as territory,\n        cast(active_devices as bigint) as active_devices,\n        cast(active_devices_last_30_days as bigint) as active_devices_last_30_days,\n        cast(deletions as bigint) as deletions,\n        cast(installations as bigint) as installations,\n        cast(sessions as bigint) as sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.216599Z", "completed_at": "2024-07-17T23:30:45.884250Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.887061Z", "completed_at": "2024-07-17T23:30:45.887066Z"}], "thread_id": "Thread-7", "execution_time": 0.763145923614502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store_source.stg_apple_store__usage_platform_version", "compiled": true, "compiled_code": "with base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    active_devices\n    \n as \n    \n    active_devices\n    \n, \n    \n    \n    active_devices_last_30_days\n    \n as \n    \n    active_devices_last_30_days\n    \n, \n    \n    \n    app_id\n    \n as \n    \n    app_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    deletions\n    \n as \n    \n    deletions\n    \n, \n    \n    \n    installations\n    \n as \n    \n    installations\n    \n, \n    \n    \n    meets_threshold\n    \n as \n    \n    meets_threshold\n    \n, \n    \n    \n    platform_version\n    \n as \n    \n    platform_version\n    \n, \n    \n    \n    sessions\n    \n as \n    \n    sessions\n    \n, \n    \n    \n    source_type\n    \n as \n    \n    source_type\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        cast(source_relation as TEXT) as source_relation, \n        cast(date as date) as date_day,\n        cast(app_id as bigint) as app_id,\n        cast(source_type as TEXT) as source_type,\n        cast(platform_version as TEXT) as platform_version,\n        cast(active_devices as bigint) as active_devices,\n        cast(active_devices_last_30_days as bigint) as active_devices_last_30_days,\n        cast(deletions as bigint) as deletions,\n        cast(installations as bigint) as installations,\n        cast(sessions as bigint) as sessions\n    from fields\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.923760Z", "completed_at": "2024-07-17T23:30:45.975201Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.979386Z", "completed_at": "2024-07-17T23:30:45.979391Z"}], "thread_id": "Thread-3", "execution_time": 0.05858922004699707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__sales_account_source_relation__account_id.4e93cfed18", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n    group by source_relation, account_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.928349Z", "completed_at": "2024-07-17T23:30:45.980070Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.982237Z", "completed_at": "2024-07-17T23:30:45.982241Z"}], "thread_id": "Thread-5", "execution_time": 0.05936789512634277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__downloads_territory_source_relation__date_day__app_id__source_type__territory.602f5096ce", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, territory\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory\"\n    group by source_relation, date_day, app_id, source_type, territory\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.975435Z", "completed_at": "2024-07-17T23:30:45.981432Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:45.985912Z", "completed_at": "2024-07-17T23:30:45.985916Z"}], "thread_id": "Thread-4", "execution_time": 0.05931806564331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__sales_subscription_summary_source_relation__date_day__account_id__app_name__subscription_name__device__country__state.4c663eea8c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, app_name, subscription_name, device, country, state\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\"\n    group by source_relation, date_day, account_id, app_name, subscription_name, device, country, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.991997Z", "completed_at": "2024-07-17T23:30:46.015634Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.023528Z", "completed_at": "2024-07-17T23:30:46.023533Z"}], "thread_id": "Thread-7", "execution_time": 0.03793478012084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_device_source_relation__date_day__app_id__source_type__device.aa048fdf6c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, device\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\"\n    group by source_relation, date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.994932Z", "completed_at": "2024-07-17T23:30:46.019599Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.023956Z", "completed_at": "2024-07-17T23:30:46.023960Z"}], "thread_id": "Thread-3", "execution_time": 0.03773903846740723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_app_version_source_relation__date_day__app_id__source_type__app_version.29b2c0e4d2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, app_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version\"\n    group by source_relation, date_day, app_id, source_type, app_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.010650Z", "completed_at": "2024-07-17T23:30:46.023115Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.044307Z", "completed_at": "2024-07-17T23:30:46.044314Z"}], "thread_id": "Thread-6", "execution_time": 0.05740809440612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__territory_report", "compiled": true, "compiled_code": "with app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store_territory as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_territory\"\n),\n\ncountry_codes as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_source\".\"apple_store_country_codes\"\n),\n\ndownloads_territory as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_territory\"\n),\n\nusage_territory as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory\"\n),\n\nreporting_grain as (\n\n    select distinct\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        territory \n    from app_store_territory\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id,\n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.territory as territory_long,\n        coalesce(official_country_codes.country_code_alpha_2, alternative_country_codes.country_code_alpha_2) as territory_short,\n        coalesce(official_country_codes.region, alternative_country_codes.region) as region,\n        coalesce(official_country_codes.sub_region, alternative_country_codes.sub_region) as sub_region,\n        coalesce(app_store_territory.impressions, 0) as impressions,\n        coalesce(app_store_territory.impressions_unique_device, 0) as impressions_unique_device,\n        coalesce(app_store_territory.page_views, 0) as page_views,\n        coalesce(app_store_territory.page_views_unique_device, 0) as page_views_unique_device,\n        coalesce(downloads_territory.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_territory.redownloads, 0) as redownloads,\n        coalesce(downloads_territory.total_downloads, 0) as total_downloads,\n        coalesce(usage_territory.active_devices, 0) as active_devices,\n        coalesce(usage_territory.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_territory.deletions, 0) as deletions,\n        coalesce(usage_territory.installations, 0) as installations,\n        coalesce(usage_territory.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store_territory \n        on reporting_grain.date_day = app_store_territory.date_day\n        and reporting_grain.source_relation = app_store_territory.source_relation\n        and reporting_grain.app_id = app_store_territory.app_id \n        and reporting_grain.source_type = app_store_territory.source_type\n        and reporting_grain.territory = app_store_territory.territory\n    left join downloads_territory\n        on reporting_grain.date_day = downloads_territory.date_day\n        and reporting_grain.source_relation = downloads_territory.source_relation\n        and reporting_grain.app_id = downloads_territory.app_id \n        and reporting_grain.source_type = downloads_territory.source_type\n        and reporting_grain.territory = downloads_territory.territory\n    left join usage_territory\n        on reporting_grain.date_day = usage_territory.date_day\n        and reporting_grain.source_relation = usage_territory.source_relation\n        and reporting_grain.app_id = usage_territory.app_id \n        and reporting_grain.source_type = usage_territory.source_type\n        and reporting_grain.territory = usage_territory.territory\n    left join country_codes as official_country_codes\n        on reporting_grain.territory = official_country_codes.country_name\n    left join country_codes as alternative_country_codes\n        on reporting_grain.territory = alternative_country_codes.alternative_country_name\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__territory_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:45.997812Z", "completed_at": "2024-07-17T23:30:46.023308Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.044692Z", "completed_at": "2024-07-17T23:30:46.044696Z"}], "thread_id": "Thread-8", "execution_time": 0.058245182037353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__app_version_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__crashes_app_version as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day, \n        app_id,\n        app_version,\n        cast(null as TEXT) as source_type,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3,4,5\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\ncrashes_app_version_report as (\n    \n    select *\n    from __dbt__cte__int_apple_store__crashes_app_version\n),\n\nusage_app_version_report as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_app_version\"\n),\n\nreporting_grain_combined as (\n    \n    select\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        app_version\n    from usage_app_version_report\n    union all \n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        app_version\n    from crashes_app_version_report\n),\n\nreporting_grain as (\n\n    select \n        distinct *\n    from reporting_grain_combined\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.app_version,\n        coalesce(crashes_app_version_report.crashes, 0) as crashes,\n        coalesce(usage_app_version_report.active_devices, 0) as active_devices,\n        coalesce(usage_app_version_report.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_app_version_report.deletions, 0) as deletions,\n        coalesce(usage_app_version_report.installations, 0) as installations,\n        coalesce(usage_app_version_report.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join crashes_app_version_report\n        on reporting_grain.date_day = crashes_app_version_report.date_day\n        and reporting_grain.source_relation = crashes_app_version_report.source_relation\n        and reporting_grain.app_id = crashes_app_version_report.app_id\n        and reporting_grain.source_type = crashes_app_version_report.source_type\n        and reporting_grain.app_version = crashes_app_version_report.app_version\n    left join usage_app_version_report\n        on reporting_grain.date_day = usage_app_version_report.date_day\n        and reporting_grain.source_relation = usage_app_version_report.source_relation\n        and reporting_grain.app_id = usage_app_version_report.app_id \n        and reporting_grain.source_type = usage_app_version_report.source_type\n        and reporting_grain.app_version = usage_app_version_report.app_version\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__app_version_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.015848Z", "completed_at": "2024-07-17T23:30:46.043798Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.045768Z", "completed_at": "2024-07-17T23:30:46.045771Z"}], "thread_id": "Thread-5", "execution_time": 0.05725407600402832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_territory_source_relation__date_day__app_id__source_type__territory.2028f8f100", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, territory\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_territory\"\n    group by source_relation, date_day, app_id, source_type, territory\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.019900Z", "completed_at": "2024-07-17T23:30:46.045021Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.046782Z", "completed_at": "2024-07-17T23:30:46.046786Z"}], "thread_id": "Thread-4", "execution_time": 0.052160024642944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store_source.dbt_utils_unique_combination_of_columns_stg_apple_store__usage_platform_version_source_relation__date_day__app_id__source_type__platform_version.c82550bed4", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version\"\n    group by source_relation, date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.024386Z", "completed_at": "2024-07-17T23:30:46.047146Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.068614Z", "completed_at": "2024-07-17T23:30:46.068620Z"}], "thread_id": "Thread-1", "execution_time": 0.05370283126831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__platform_version_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__platform_version as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_platform_version\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day, \n        app_id,\n        platform_version,\n        cast(null as TEXT) as source_type,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3,4,5\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store_platform_version as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_platform_version\"\n),\n\ncrashes_platform_version as (\n    \n    select *\n    from __dbt__cte__int_apple_store__platform_version\n),\n\ndownloads_platform_version as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_platform_version\"\n),\n\nusage_platform_version as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_platform_version\"\n),\n\nreporting_grain_combined as (\n\n    select\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        platform_version\n    from app_store_platform_version\n    union all\n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        platform_version\n    from crashes_platform_version\n),\n\nreporting_grain as (\n\n    select \n        distinct *\n    from reporting_grain_combined\n\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.platform_version,\n        coalesce(app_store_platform_version.impressions, 0) as impressions,\n        coalesce(app_store_platform_version.impressions_unique_device, 0) as impressions_unique_device,\n        coalesce(app_store_platform_version.page_views, 0) as page_views,\n        coalesce(app_store_platform_version.page_views_unique_device, 0) as page_views_unique_device,\n        coalesce(crashes_platform_version.crashes, 0) as crashes,\n        coalesce(downloads_platform_version.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_platform_version.redownloads, 0) as redownloads,\n        coalesce(downloads_platform_version.total_downloads, 0) as total_downloads,\n        coalesce(usage_platform_version.active_devices, 0) as active_devices,\n        coalesce(usage_platform_version.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_platform_version.deletions, 0) as deletions,\n        coalesce(usage_platform_version.installations, 0) as installations,\n        coalesce(usage_platform_version.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store_platform_version \n        on reporting_grain.date_day = app_store_platform_version.date_day\n        and reporting_grain.source_relation = app_store_platform_version.source_relation\n        and reporting_grain.app_id = app_store_platform_version.app_id \n        and reporting_grain.source_type = app_store_platform_version.source_type\n        and reporting_grain.platform_version = app_store_platform_version.platform_version\n    left join crashes_platform_version\n        on reporting_grain.date_day = crashes_platform_version.date_day\n        and reporting_grain.source_relation = crashes_platform_version.source_relation\n        and reporting_grain.app_id = crashes_platform_version.app_id\n        and reporting_grain.source_type = crashes_platform_version.source_type\n        and reporting_grain.platform_version = crashes_platform_version.platform_version    \n    left join downloads_platform_version\n        on reporting_grain.date_day = downloads_platform_version.date_day\n        and reporting_grain.source_relation = downloads_platform_version.source_relation\n        and reporting_grain.app_id = downloads_platform_version.app_id \n        and reporting_grain.source_type = downloads_platform_version.source_type\n        and reporting_grain.platform_version = downloads_platform_version.platform_version\n    left join usage_platform_version\n        on reporting_grain.date_day = usage_platform_version.date_day\n        and reporting_grain.source_relation = usage_platform_version.source_relation\n        and reporting_grain.app_id = usage_platform_version.app_id \n        and reporting_grain.source_type = usage_platform_version.source_type\n        and reporting_grain.platform_version = usage_platform_version.platform_version\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__platform_version_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.048290Z", "completed_at": "2024-07-17T23:30:46.093203Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.123922Z", "completed_at": "2024-07-17T23:30:46.123929Z"}], "thread_id": "Thread-2", "execution_time": 0.07997393608093262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__subscription_report", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__int_apple_store__sales_subscription_summary as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n),\n\njoined as (\n\n    select \n        base.source_relation,\n        base.date_day,\n        base.account_id,\n        sales_account.account_name,\n        app.app_id,\n        base.app_name,\n        base.subscription_name,\n        base.country,\n        base.state,\n        sum(base.active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(base.active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(base.active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(base.active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from base\n    left join app \n        on base.app_name = app.app_name\n        and base.source_relation = app.source_relation\n    left join sales_account \n        on base.account_id = sales_account.account_id\n        and base.source_relation = sales_account.source_relation\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__sales_subscription_events as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n),\n\nfiltered as (\n\n    select *\n    from base \n    where lower(event)\n        in (\n            \n                \n                'renew'\n            \n                \n                , \n                \n                'cancel'\n            \n                \n                , \n                \n                'subscribe'\n               \n        )\n),\n\npivoted as (\n    \n    select\n        date_day\n        , source_relation\n        , account_id\n        , app_name\n        , subscription_name\n        , country\n        , state\n        \n        , sum(case when lower(event) = 'renew' then quantity else 0 end) as event_renew\n        \n        , sum(case when lower(event) = 'cancel' then quantity else 0 end) as event_cancel\n        \n        , sum(case when lower(event) = 'subscribe' then quantity else 0 end) as event_subscribe\n        \n    from filtered\n    group by 1,2,3,4,5,6,7\n),\n\njoined as (\n\n    select \n        pivoted.source_relation,\n        pivoted.date_day,\n        pivoted.account_id,\n        sales_account.account_name,\n        app.app_id,\n        pivoted.app_name,\n        pivoted.subscription_name,\n        pivoted.country,\n        pivoted.state\n        \n        , pivoted.event_renew\n        \n        , pivoted.event_cancel\n        \n        , pivoted.event_subscribe\n        \n    from pivoted\n    left join app \n        on pivoted.app_name = app.app_name\n        and pivoted.source_relation = app.source_relation\n    left join sales_account \n        on pivoted.account_id = sales_account.account_id\n        and pivoted.source_relation = sales_account.source_relation\n)\n\nselect * \nfrom joined\n), subscription_summary as (\n\n    select *\n    from __dbt__cte__int_apple_store__sales_subscription_summary\n),\n\nsubscription_events as (\n\n    select *\n    from __dbt__cte__int_apple_store__sales_subscription_events\n),\n\ncountry_codes as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_source\".\"apple_store_country_codes\"\n),\n\nreporting_grain_combined as (\n\n    select\n        source_relation,\n        cast(date_day as date) as date_day,\n        account_id,\n        account_name,\n        app_name,\n        app_id,\n        subscription_name,\n        country,\n        state \n    from subscription_summary\n    union all\n    select\n        source_relation,\n        cast(date_day as date) as date_day,\n        account_id,\n        account_name,\n        app_name,\n        app_id,\n        subscription_name,\n        country,\n        state \n    from subscription_events\n),\n\nreporting_grain as (\n\n    select \n        distinct *\n    from reporting_grain_combined\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.account_id,\n        reporting_grain.account_name, \n        reporting_grain.app_id,\n        reporting_grain.app_name,\n        reporting_grain.subscription_name, \n        case \n            when country_codes.alternative_country_name is null then country_codes.country_name\n            else country_codes.alternative_country_name\n        end as territory_long,\n        reporting_grain.country as territory_short,\n        reporting_grain.state,\n        country_codes.region, \n        country_codes.sub_region,\n        coalesce(subscription_summary.active_free_trial_introductory_offer_subscriptions, 0) as active_free_trial_introductory_offer_subscriptions,\n        coalesce(subscription_summary.active_pay_as_you_go_introductory_offer_subscriptions, 0) as active_pay_as_you_go_introductory_offer_subscriptions,\n        coalesce(subscription_summary.active_pay_up_front_introductory_offer_subscriptions, 0) as active_pay_up_front_introductory_offer_subscriptions,\n        coalesce(subscription_summary.active_standard_price_subscriptions, 0) as active_standard_price_subscriptions\n        \n        \n        , coalesce(subscription_events.event_renew, 0)\n            as event_renew \n        \n        \n        , coalesce(subscription_events.event_cancel, 0)\n            as event_cancel \n        \n        \n        , coalesce(subscription_events.event_subscribe, 0)\n            as event_subscribe \n        \n    from reporting_grain\n    left join subscription_summary\n        on reporting_grain.date_day = subscription_summary.date_day\n        and reporting_grain.source_relation = subscription_summary.source_relation\n        and reporting_grain.account_id =  subscription_summary.account_id \n        and reporting_grain.app_name = subscription_summary.app_name\n        and reporting_grain.subscription_name = subscription_summary.subscription_name\n        and reporting_grain.country = subscription_summary.country\n        and (reporting_grain.state = subscription_summary.state or (reporting_grain.state is null and subscription_summary.state is null))\n    left join subscription_events\n        on reporting_grain.date_day = subscription_events.date_day\n        and reporting_grain.source_relation = subscription_events.source_relation\n        and reporting_grain.account_id =  subscription_events.account_id \n        and reporting_grain.app_name = subscription_events.app_name\n        and reporting_grain.subscription_name = subscription_events.subscription_name\n        and reporting_grain.country = subscription_events.country\n        and (reporting_grain.state = subscription_events.state or (reporting_grain.state is null and subscription_events.state is null))\n    left join country_codes\n        on reporting_grain.country = country_codes.country_code_alpha_2\n    \n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__subscription_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.113460Z", "completed_at": "2024-07-17T23:30:46.128497Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.132669Z", "completed_at": "2024-07-17T23:30:46.132674Z"}], "thread_id": "Thread-8", "execution_time": 0.06372714042663574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__territory_report_source_relation__date_day__app_id__source_type__territory_long.1f8ce77eb8", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, territory_long\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__territory_report\"\n    group by source_relation, date_day, app_id, source_type, territory_long\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.080648Z", "completed_at": "2024-07-17T23:30:46.128720Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.133271Z", "completed_at": "2024-07-17T23:30:46.133275Z"}], "thread_id": "Thread-3", "execution_time": 0.0855100154876709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__device_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__crashes_device as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day, \n        app_id,\n        device,\n        cast(null as TEXT) as source_type,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3,4,5\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__subscription_device as (\n\n\nwith app as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsubscription_summary as (\n\n    select\n        source_relation,\n        date_day,\n        app_name,\n        device,\n        sum(active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\"\n    group by 1,2,3,4\n), \n\nfiltered_subscription_events as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\" \n    where lower(event)\n        in (\n            \n                \n                'renew'\n            \n                \n                , \n                \n                'cancel'\n            \n                \n                , \n                \n                'subscribe'\n               \n        )\n),\n\npivoted_subscription_events as (\n    \n    select\n        source_relation,\n        date_day,\n        app_name,\n        device\n        \n        , sum(case when lower(event) = 'renew' then quantity else 0 end) as event_renew\n        \n        , sum(case when lower(event) = 'cancel' then quantity else 0 end) as event_cancel\n        \n        , sum(case when lower(event) = 'subscribe' then quantity else 0 end) as event_subscribe\n        \n    from filtered_subscription_events\n    group by 1,2,3,4\n),\n\njoined as (\n\n    select \n        app.app_id,\n        pivoted_subscription_events.*,\n        subscription_summary.active_free_trial_introductory_offer_subscriptions,\n        subscription_summary.active_pay_as_you_go_introductory_offer_subscriptions,\n        subscription_summary.active_pay_up_front_introductory_offer_subscriptions,\n        subscription_summary.active_standard_price_subscriptions,\n        cast(null as TEXT) as source_type\n    from subscription_summary \n    left join pivoted_subscription_events\n        on subscription_summary.date_day = pivoted_subscription_events.date_day\n        and subscription_summary.source_relation = pivoted_subscription_events.source_relation\n        and subscription_summary.app_name = pivoted_subscription_events.app_name\n        and subscription_summary.device = pivoted_subscription_events.device\n    left join app \n        on subscription_summary.app_name = app.app_name\n        and subscription_summary.source_relation = app.source_relation\n)\n\nselect * \nfrom joined\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store_device as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\"\n),\n\ndownloads_device as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\"\n),\n\nusage_device as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\"\n),\n\ncrashes_device as (\n\n    select *\n    from __dbt__cte__int_apple_store__crashes_device\n),\n\n\nsubscription_device as (\n\n    select *\n    from __dbt__cte__int_apple_store__subscription_device\n),\n\n\nreporting_grain_combined as (\n\n    select\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        device \n    from app_store_device\n    union all\n    select\n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        device\n    from crashes_device\n),\n\nreporting_grain as (\n    \n    select\n        distinct *\n    from reporting_grain_combined\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        reporting_grain.device,\n        coalesce(app_store_device.impressions, 0) as impressions,\n        coalesce(app_store_device.impressions_unique_device, 0) as impressions_unique_device,\n        coalesce(app_store_device.page_views, 0) as page_views,\n        coalesce(app_store_device.page_views_unique_device, 0) as page_views_unique_device,\n        coalesce(crashes_device.crashes, 0) as crashes,\n        coalesce(downloads_device.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_device.redownloads, 0) as redownloads,\n        coalesce(downloads_device.total_downloads, 0) as total_downloads,\n        coalesce(usage_device.active_devices, 0) as active_devices,\n        coalesce(usage_device.active_devices_last_30_days, 0) as active_devices_last_30_days,\n        coalesce(usage_device.deletions, 0) as deletions,\n        coalesce(usage_device.installations, 0) as installations,\n        coalesce(usage_device.sessions, 0) as sessions\n        \n        ,\n        coalesce(subscription_device.active_free_trial_introductory_offer_subscriptions, 0) as active_free_trial_introductory_offer_subscriptions,\n        coalesce(subscription_device.active_pay_as_you_go_introductory_offer_subscriptions, 0) as active_pay_a_you_go_introductory_offer_subscriptions,\n        coalesce(subscription_device.active_pay_up_front_introductory_offer_subscriptions, 0) as active_pay_up_front_introductory_offer_subscriptions,\n        coalesce(subscription_device.active_standard_price_subscriptions, 0) as active_standard_price_subscriptions\n        \n        \n        , coalesce(subscription_device.event_renew, 0)\n            as event_renew \n        \n        \n        , coalesce(subscription_device.event_cancel, 0)\n            as event_cancel \n        \n        \n        , coalesce(subscription_device.event_subscribe, 0)\n            as event_subscribe \n        \n        \n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store_device \n        on reporting_grain.date_day = app_store_device.date_day\n        and reporting_grain.source_relation = app_store_device.source_relation\n        and reporting_grain.app_id = app_store_device.app_id \n        and reporting_grain.source_type = app_store_device.source_type\n        and reporting_grain.device = app_store_device.device\n    left join crashes_device\n        on reporting_grain.date_day = crashes_device.date_day\n        and reporting_grain.source_relation = crashes_device.source_relation\n        and reporting_grain.app_id = crashes_device.app_id\n        and reporting_grain.source_type = crashes_device.source_type\n        and reporting_grain.device = crashes_device.device\n    left join downloads_device\n        on reporting_grain.date_day = downloads_device.date_day\n        and reporting_grain.source_relation = downloads_device.source_relation\n        and reporting_grain.app_id = downloads_device.app_id \n        and reporting_grain.source_type = downloads_device.source_type\n        and reporting_grain.device = downloads_device.device\n    \n    left join subscription_device\n        on reporting_grain.date_day = subscription_device.date_day\n        and reporting_grain.source_relation = subscription_device.source_relation\n        and reporting_grain.app_id = subscription_device.app_id \n        and reporting_grain.source_type = subscription_device.source_type\n        and reporting_grain.device = subscription_device.device\n    \n    left join usage_device\n        on reporting_grain.date_day = usage_device.date_day\n        and reporting_grain.source_relation = usage_device.source_relation\n        and reporting_grain.app_id = usage_device.app_id \n        and reporting_grain.source_type = usage_device.source_type\n        and reporting_grain.device = usage_device.device\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__device_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.107174Z", "completed_at": "2024-07-17T23:30:46.128976Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.133632Z", "completed_at": "2024-07-17T23:30:46.133635Z"}], "thread_id": "Thread-6", "execution_time": 0.0728600025177002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__source_type_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__app_store_source_type as (\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        sum(impressions) as impressions,\n        sum(page_views) as page_views\n    from base \n    group by 1,2,3,4\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__downloads_source_type as (\nwith base as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        sum(first_time_downloads) as first_time_downloads,\n        sum(redownloads) as redownloads,\n        sum(total_downloads) as total_downloads\n    from base \n    group by 1,2,3,4\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__usage_source_type as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        source_type,\n        sum(active_devices) as active_devices,\n        sum(deletions) as deletions,\n        sum(installations) as installations,\n        sum(sessions) as sessions\n    from base\n    group by 1,2,3,4\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store_source_type as (\n\n    select *\n    from __dbt__cte__int_apple_store__app_store_source_type\n),\n\ndownloads_source_type as (\n\n    select *\n    from __dbt__cte__int_apple_store__downloads_source_type\n),\n\nusage_source_type as (\n\n    select *\n    from __dbt__cte__int_apple_store__usage_source_type\n),\n\nreporting_grain as (\n\n    select distinct\n        source_relation,\n        date_day,\n        app_id,\n        source_type\n    from app_store_source_type\n),\n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id, \n        app.app_name,\n        reporting_grain.source_type,\n        coalesce(app_store_source_type.impressions, 0) as impressions,\n        coalesce(app_store_source_type.page_views, 0) as page_views,\n        coalesce(downloads_source_type.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads_source_type.redownloads, 0) as redownloads,\n        coalesce(downloads_source_type.total_downloads, 0) as total_downloads,\n        coalesce(usage_source_type.active_devices, 0) as active_devices,\n        coalesce(usage_source_type.deletions, 0) as deletions,\n        coalesce(usage_source_type.installations, 0) as installations,\n        coalesce(usage_source_type.sessions, 0) as sessions\n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store_source_type\n        on reporting_grain.date_day = app_store_source_type.date_day\n        and reporting_grain.source_relation = app_store_source_type.source_relation\n        and reporting_grain.app_id = app_store_source_type.app_id \n        and reporting_grain.source_type = app_store_source_type.source_type\n    left join downloads_source_type\n        on reporting_grain.date_day = downloads_source_type.date_day\n        and reporting_grain.source_relation = downloads_source_type.source_relation\n        and reporting_grain.app_id = downloads_source_type.app_id \n        and reporting_grain.source_type = downloads_source_type.source_type\n    left join usage_source_type\n        on reporting_grain.date_day = usage_source_type.date_day\n        and reporting_grain.source_relation = usage_source_type.source_relation\n        and reporting_grain.app_id = usage_source_type.app_id \n        and reporting_grain.source_type = usage_source_type.source_type\n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__source_type_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.124324Z", "completed_at": "2024-07-17T23:30:46.133052Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.134728Z", "completed_at": "2024-07-17T23:30:46.134731Z"}], "thread_id": "Thread-5", "execution_time": 0.06519198417663574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__app_version_report_source_relation__date_day__app_id__source_type__app_version.e43e9ef143", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, app_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__app_version_report\"\n    group by source_relation, date_day, app_id, source_type, app_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.129231Z", "completed_at": "2024-07-17T23:30:46.134502Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.139415Z", "completed_at": "2024-07-17T23:30:46.139419Z"}], "thread_id": "Thread-4", "execution_time": 0.0158841609954834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__platform_version_report_source_relation__date_day__app_id__source_type__platform_version.f053b826be", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, platform_version\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__platform_version_report\"\n    group by source_relation, date_day, app_id, source_type, platform_version\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.135457Z", "completed_at": "2024-07-17T23:30:46.158689Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.160994Z", "completed_at": "2024-07-17T23:30:46.161000Z"}], "thread_id": "Thread-1", "execution_time": 0.028934717178344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__subscription_report_source_relation__date_day__account_id__app_id__subscription_name__territory_long__state.77cd2fc10f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, account_id, app_id, subscription_name, territory_long, state\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__subscription_report\"\n    group by source_relation, date_day, account_id, app_id, subscription_name, territory_long, state\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.140359Z", "completed_at": "2024-07-17T23:30:46.166966Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.167200Z", "completed_at": "2024-07-17T23:30:46.167204Z"}], "thread_id": "Thread-2", "execution_time": 0.03304409980773926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.apple_store.apple_store__overview_report", "compiled": true, "compiled_code": "with  __dbt__cte__int_apple_store__app_store_overview as (\nwith base as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app_store_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        sum(impressions) as impressions,\n        sum(page_views) as page_views\n    from base \n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__crashes_overview as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__crashes_app_version\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day, \n        app_id,\n        sum(crashes) as crashes\n    from base\n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__downloads_overview as (\nwith base as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__downloads_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        sum(first_time_downloads) as first_time_downloads,\n        sum(redownloads) as redownloads,\n        sum(total_downloads) as total_downloads\n    from base \n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n),  __dbt__cte__int_apple_store__sales_subscription_summary as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_summary\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n),\n\njoined as (\n\n    select \n        base.source_relation,\n        base.date_day,\n        base.account_id,\n        sales_account.account_name,\n        app.app_id,\n        base.app_name,\n        base.subscription_name,\n        base.country,\n        base.state,\n        sum(base.active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(base.active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(base.active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(base.active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from base\n    left join app \n        on base.app_name = app.app_name\n        and base.source_relation = app.source_relation\n    left join sales_account \n        on base.account_id = sales_account.account_id\n        and base.source_relation = sales_account.source_relation\n    group by 1,2,3,4,5,6,7,8,9\n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__sales_subscription_events as (\n\n\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_subscription_events\"\n),\n\napp as (\n    \n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\nsales_account as (\n    \n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__sales_account\"\n),\n\nfiltered as (\n\n    select *\n    from base \n    where lower(event)\n        in (\n            \n                \n                'renew'\n            \n                \n                , \n                \n                'cancel'\n            \n                \n                , \n                \n                'subscribe'\n               \n        )\n),\n\npivoted as (\n    \n    select\n        date_day\n        , source_relation\n        , account_id\n        , app_name\n        , subscription_name\n        , country\n        , state\n        \n        , sum(case when lower(event) = 'renew' then quantity else 0 end) as event_renew\n        \n        , sum(case when lower(event) = 'cancel' then quantity else 0 end) as event_cancel\n        \n        , sum(case when lower(event) = 'subscribe' then quantity else 0 end) as event_subscribe\n        \n    from filtered\n    group by 1,2,3,4,5,6,7\n),\n\njoined as (\n\n    select \n        pivoted.source_relation,\n        pivoted.date_day,\n        pivoted.account_id,\n        sales_account.account_name,\n        app.app_id,\n        pivoted.app_name,\n        pivoted.subscription_name,\n        pivoted.country,\n        pivoted.state\n        \n        , pivoted.event_renew\n        \n        , pivoted.event_cancel\n        \n        , pivoted.event_subscribe\n        \n    from pivoted\n    left join app \n        on pivoted.app_name = app.app_name\n        and pivoted.source_relation = app.source_relation\n    left join sales_account \n        on pivoted.account_id = sales_account.account_id\n        and pivoted.source_relation = sales_account.source_relation\n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__sales_subscription_overview as (\n\n\nwith subscription_summary as (\n\n    select\n        source_relation,\n        date_day,\n        app_id,\n        sum(active_free_trial_introductory_offer_subscriptions) as active_free_trial_introductory_offer_subscriptions,\n        sum(active_pay_as_you_go_introductory_offer_subscriptions) as active_pay_as_you_go_introductory_offer_subscriptions,\n        sum(active_pay_up_front_introductory_offer_subscriptions) as active_pay_up_front_introductory_offer_subscriptions,\n        sum(active_standard_price_subscriptions) as active_standard_price_subscriptions\n    from __dbt__cte__int_apple_store__sales_subscription_summary\n    group by 1,2,3\n), \n\nsubscription_events as (\n\n    select \n        source_relation,\n        date_day,\n        app_id\n        \n        \n        , coalesce(sum(event_renew), 0)\n            as event_renew \n        \n        \n        , coalesce(sum(event_cancel), 0)\n            as event_cancel \n        \n        \n        , coalesce(sum(event_subscribe), 0)\n            as event_subscribe \n        \n    from __dbt__cte__int_apple_store__sales_subscription_events\n    group by 1,2,3\n), \n\njoined as (\n\n    select \n        subscription_events.*,\n        active_free_trial_introductory_offer_subscriptions,\n        active_pay_as_you_go_introductory_offer_subscriptions,\n        active_pay_up_front_introductory_offer_subscriptions,\n        active_standard_price_subscriptions\n    from subscription_summary \n    left join subscription_events\n        on subscription_summary.date_day = subscription_events.date_day\n        and subscription_summary.source_relation = subscription_events.source_relation\n        and subscription_summary.app_id = subscription_events.app_id \n)\n\nselect * \nfrom joined\n),  __dbt__cte__int_apple_store__usage_overview as (\nwith base as (\n\n    select *\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__usage_device\"\n),\n\naggregated as (\n\n    select \n        source_relation,\n        date_day,\n        app_id,\n        sum(active_devices) as active_devices,\n        sum(deletions) as deletions,\n        sum(installations) as installations,\n        sum(sessions) as sessions\n    from base\n    group by 1,2,3\n)\n\nselect * \nfrom aggregated\n), app as (\n\n    select * \n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"stg_apple_store__app\"\n),\n\napp_store as (\n\n    select *\n    from __dbt__cte__int_apple_store__app_store_overview\n),\n\ncrashes as (\n\n    select *\n    from __dbt__cte__int_apple_store__crashes_overview\n),\n\ndownloads as (\n\n    select *\n    from __dbt__cte__int_apple_store__downloads_overview\n),\n\n\nsubscriptions as (\n\n    select *\n    from __dbt__cte__int_apple_store__sales_subscription_overview\n), \n\n\nusage as (\n\n    select *\n    from __dbt__cte__int_apple_store__usage_overview\n),\n\nreporting_grain as (\n\n    select distinct\n        source_relation,\n        date_day,\n        app_id \n    from app_store\n), \n\njoined as (\n\n    select \n        reporting_grain.source_relation,\n        reporting_grain.date_day,\n        reporting_grain.app_id,\n        app.app_name,\n        coalesce(app_store.impressions, 0) as impressions,\n        coalesce(app_store.page_views, 0) as page_views,\n        coalesce(crashes.crashes,0) as crashes,\n        coalesce(downloads.first_time_downloads, 0) as first_time_downloads,\n        coalesce(downloads.redownloads, 0) as redownloads,\n        coalesce(downloads.total_downloads, 0) as total_downloads,\n        coalesce(usage.active_devices, 0) as active_devices,\n        coalesce(usage.deletions, 0) as deletions,\n        coalesce(usage.installations, 0) as installations,\n        coalesce(usage.sessions, 0) as sessions\n        \n        ,\n        coalesce(subscriptions.active_free_trial_introductory_offer_subscriptions, 0) as active_free_trial_introductory_offer_subscriptions,\n        coalesce(subscriptions.active_pay_as_you_go_introductory_offer_subscriptions, 0) as active_pay_as_you_go_introductory_offer_subscriptions,\n        coalesce(subscriptions.active_pay_up_front_introductory_offer_subscriptions, 0) as active_pay_up_front_introductory_offer_subscriptions,\n        coalesce(subscriptions.active_standard_price_subscriptions, 0) as active_standard_price_subscriptions\n        \n        \n        , coalesce(subscriptions.event_renew, 0)\n            as event_renew \n        \n        \n        , coalesce(subscriptions.event_cancel, 0)\n            as event_cancel \n        \n        \n        , coalesce(subscriptions.event_subscribe, 0)\n            as event_subscribe \n        \n        \n    from reporting_grain\n    left join app \n        on reporting_grain.app_id = app.app_id\n        and reporting_grain.source_relation = app.source_relation\n    left join app_store \n        on reporting_grain.date_day = app_store.date_day\n        and reporting_grain.source_relation = app_store.source_relation\n        and reporting_grain.app_id = app_store.app_id\n    left join crashes\n        on reporting_grain.date_day = crashes.date_day\n        and reporting_grain.source_relation = crashes.source_relation\n        and reporting_grain.app_id = crashes.app_id\n    left join downloads\n        on reporting_grain.date_day = downloads.date_day\n        and reporting_grain.source_relation = downloads.source_relation\n        and reporting_grain.app_id = downloads.app_id\n    \n    left join subscriptions \n        on reporting_grain.date_day = subscriptions.date_day\n        and reporting_grain.source_relation = subscriptions.source_relation\n        and reporting_grain.app_id = subscriptions.app_id\n    \n    left join usage\n        on reporting_grain.date_day = usage.date_day\n        and reporting_grain.source_relation = usage.source_relation\n        and reporting_grain.app_id = usage.app_id        \n)\n\nselect * \nfrom joined", "relation_name": "\"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__overview_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.164094Z", "completed_at": "2024-07-17T23:30:46.167688Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.168366Z", "completed_at": "2024-07-17T23:30:46.168369Z"}], "thread_id": "Thread-3", "execution_time": 0.028306007385253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__source_type_report_source_relation__date_day__app_id__source_type.5f6e6bf648", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__source_type_report\"\n    group by source_relation, date_day, app_id, source_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.161399Z", "completed_at": "2024-07-17T23:30:46.167913Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.168738Z", "completed_at": "2024-07-17T23:30:46.168741Z"}], "thread_id": "Thread-7", "execution_time": 0.028949975967407227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__device_report_source_relation__date_day__app_id__source_type__device.c04feac50f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id, source_type, device\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__device_report\"\n    group by source_relation, date_day, app_id, source_type, device\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-07-17T23:30:46.169639Z", "completed_at": "2024-07-17T23:30:46.173401Z"}, {"name": "execute", "started_at": "2024-07-17T23:30:46.173617Z", "completed_at": "2024-07-17T23:30:46.173621Z"}], "thread_id": "Thread-8", "execution_time": 0.004589080810546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.apple_store.dbt_utils_unique_combination_of_columns_apple_store__overview_report_source_relation__date_day__app_id.22a03a68cc", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, app_id\n    from \"postgres\".\"zz_apple_store_apple_store_dev\".\"apple_store__overview_report\"\n    group by source_relation, date_day, app_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}], "elapsed_time": 5.158243894577026, "args": {"indirect_selection": "eager", "strict_mode": false, "write_json": true, "introspect": true, "profiles_dir": "/Users/catherinefritz/.dbt", "use_colors": true, "send_anonymous_usage_stats": true, "cache_selected_only": false, "use_colors_file": true, "static_parser": true, "warn_error_options": {"include": [], "exclude": []}, "populate_cache": true, "log_level": "info", "log_format": "default", "partial_parse_file_diff": true, "compile": true, "favor_state": false, "project_dir": "/Users/catherinefritz/Documents/dbt_packages/apple_store/dbt_apple_store/integration_tests", "require_resource_names_without_spaces": false, "select": [], "log_file_max_bytes": 10485760, "static": false, "version_check": true, "partial_parse": true, "enable_legacy_logger": false, "exclude": [], "macro_debugging": false, "log_path": "/Users/catherinefritz/Documents/dbt_packages/apple_store/dbt_apple_store/integration_tests/logs", "log_format_file": "debug", "defer": false, "vars": {}, "require_explicit_package_overrides_for_builtin_materializations": true, "quiet": false, "source_freshness_run_project_hooks": false, "print": true, "show_resource_report": false, "log_level_file": "debug", "printer_width": 80, "which": "generate", "invocation_command": "dbt docs generate", "empty_catalog": false}}